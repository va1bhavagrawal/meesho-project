/home2/vaibhav19ada/miniconda3/envs/contwords/lib/python3.9/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
vae/config.json: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 611/611 [00:00<00:00, 61.3kB/s]



diffusion_pytorch_model.safetensors: 100%|██████████████████████████████████████████████████████████████████████████████████| 335M/335M [00:06<00:00, 55.4MB/s]
Updating cross attention only!
['CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'UNetMidBlock2DCrossAttn', 'Attention', 'Attention', 'GEGLU']
Differences: 0
Updating cross attention only!
['CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention']
/home2/vaibhav19ada/miniconda3/envs/contwords/lib/python3.9/site-packages/diffusers/configuration_utils.py:215: FutureWarning: It is deprecated to pass a pretrained model name or path to `from_config`.If you were trying to load a scheduler, please use <class 'diffusers.schedulers.scheduling_ddpm.DDPMScheduler'>.from_pretrained(...) instead. Otherwise, please make sure to pass a configuration dictionary instead. This functionality will be removed in v1.0.0.
  deprecate("config-passed-as-path", "1.0.0", deprecation_message, standard_warn=False)
Differences: 0
Length of images used for training 180
The current continuous MLP: continuous_word_mlp(
  (fc1): Linear(in_features=2, out_features=20, bias=True)
  (fc2): Linear(in_features=20, out_features=1024, bias=True)
  (relu): ReLU()
  (tanh): Tanh()
)
Steps:   0%|                                                                                                                         | 0/30000 [00:00<?, ?it/s]

Steps:   0%|                                                             | 4/30000 [00:10<22:05:08,  2.65s/it, loss=tensor(0.6949, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   0%|                                                             | 12/30000 [00:13<7:02:26,  1.18it/s, loss=tensor(0.5409, device='cuda:0'), lr=0.0004]

Steps:   0%|                                                             | 16/30000 [00:14<5:19:14,  1.57it/s, loss=tensor(0.5270, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   0%|                                                             | 24/30000 [00:17<3:48:05,  2.19it/s, loss=tensor(0.5260, device='cuda:0'), lr=0.0004]

Steps:   0%|                                                             | 28/30000 [00:18<3:27:16,  2.41it/s, loss=tensor(0.5276, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   0%|                                                             | 36/30000 [00:21<3:04:39,  2.70it/s, loss=tensor(0.4910, device='cuda:0'), lr=0.0004]

Steps:   0%|                                                             | 40/30000 [00:22<2:58:16,  2.80it/s, loss=tensor(0.6662, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   0%|                                                             | 48/30000 [00:24<2:49:33,  2.94it/s, loss=tensor(0.5994, device='cuda:0'), lr=0.0004]

Steps:   0%|                                                             | 52/30000 [00:26<2:54:02,  2.87it/s, loss=tensor(0.6539, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   0%|                                                             | 60/30000 [00:29<2:47:24,  2.98it/s, loss=tensor(0.4515, device='cuda:0'), lr=0.0004]

Steps:   0%|▏                                                            | 64/30000 [00:30<2:45:49,  3.01it/s, loss=tensor(0.5586, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   0%|▏                                                            | 72/30000 [00:32<2:44:23,  3.03it/s, loss=tensor(0.5414, device='cuda:0'), lr=0.0004]

Steps:   0%|▏                                                            | 76/30000 [00:34<2:43:32,  3.05it/s, loss=tensor(0.7714, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   0%|▏                                                            | 84/30000 [00:36<2:43:39,  3.05it/s, loss=tensor(0.6991, device='cuda:0'), lr=0.0004]

Steps:   0%|▏                                                            | 88/30000 [00:38<2:43:14,  3.05it/s, loss=tensor(0.5810, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   0%|▏                                                            | 96/30000 [00:40<2:43:56,  3.04it/s, loss=tensor(0.6421, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   0%|▏                                                           | 104/30000 [00:43<2:43:14,  3.05it/s, loss=tensor(0.7312, device='cuda:0'), lr=0.0004]

Steps:   0%|▏                                                           | 108/30000 [00:44<2:43:15,  3.05it/s, loss=tensor(0.5742, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   0%|▏                                                           | 116/30000 [00:47<2:42:53,  3.06it/s, loss=tensor(0.4221, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   0%|▏                                                           | 120/30000 [00:48<2:42:47,  3.06it/s, loss=tensor(0.6025, device='cuda:0'), lr=0.0004]

Steps:   0%|▎                                                           | 128/30000 [00:51<2:42:51,  3.06it/s, loss=tensor(0.5548, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   0%|▎                                                           | 132/30000 [00:52<2:42:47,  3.06it/s, loss=tensor(0.4945, device='cuda:0'), lr=0.0004]

Steps:   0%|▎                                                           | 140/30000 [00:55<2:42:55,  3.05it/s, loss=tensor(0.5842, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   0%|▎                                                           | 144/30000 [00:56<2:43:01,  3.05it/s, loss=tensor(0.5515, device='cuda:0'), lr=0.0004]

Steps:   1%|▎                                                           | 152/30000 [00:59<2:43:30,  3.04it/s, loss=tensor(0.7308, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   1%|▎                                                           | 156/30000 [01:00<2:43:08,  3.05it/s, loss=tensor(0.5153, device='cuda:0'), lr=0.0004]

Steps:   1%|▎                                                           | 164/30000 [01:03<2:42:32,  3.06it/s, loss=tensor(0.5084, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   1%|▎                                                           | 168/30000 [01:04<2:42:53,  3.05it/s, loss=tensor(0.5375, device='cuda:0'), lr=0.0004]

Steps:   1%|▎                                                           | 176/30000 [01:07<2:44:20,  3.02it/s, loss=tensor(0.6160, device='cuda:0'), lr=0.0004]

Steps:   1%|▎                                                           | 180/30000 [01:08<2:48:47,  2.94it/s, loss=tensor(0.4978, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   1%|▍                                                           | 188/30000 [01:11<2:54:18,  2.85it/s, loss=tensor(0.4943, device='cuda:0'), lr=0.0004]

Steps:   1%|▍                                                           | 192/30000 [01:12<2:51:00,  2.91it/s, loss=tensor(0.5884, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   1%|▍                                                           | 200/30000 [01:15<2:46:55,  2.98it/s, loss=tensor(0.5105, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   1%|▍                                                           | 204/30000 [01:16<2:45:39,  3.00it/s, loss=tensor(0.4769, device='cuda:0'), lr=0.0004]

Steps:   1%|▍                                                           | 212/30000 [01:19<2:44:12,  3.02it/s, loss=tensor(0.5473, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   1%|▍                                                           | 216/30000 [01:20<2:44:40,  3.01it/s, loss=tensor(0.4690, device='cuda:0'), lr=0.0004]

Steps:   1%|▍                                                           | 224/30000 [01:23<2:43:15,  3.04it/s, loss=tensor(0.4672, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   1%|▍                                                           | 228/30000 [01:24<2:43:30,  3.03it/s, loss=tensor(0.6127, device='cuda:0'), lr=0.0004]

Steps:   1%|▍                                                           | 236/30000 [01:27<2:42:30,  3.05it/s, loss=tensor(0.6035, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   1%|▍                                                           | 240/30000 [01:28<2:42:48,  3.05it/s, loss=tensor(0.6058, device='cuda:0'), lr=0.0004]

Steps:   1%|▍                                                           | 248/30000 [01:31<2:43:45,  3.03it/s, loss=tensor(0.7948, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   1%|▌                                                           | 252/30000 [01:32<2:43:57,  3.02it/s, loss=tensor(0.6479, device='cuda:0'), lr=0.0004]

Steps:   1%|▌                                                           | 260/30000 [01:35<2:43:43,  3.03it/s, loss=tensor(0.5947, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   1%|▌                                                           | 264/30000 [01:36<2:42:55,  3.04it/s, loss=tensor(0.4453, device='cuda:0'), lr=0.0004]

Steps:   1%|▌                                                           | 272/30000 [01:39<2:43:11,  3.04it/s, loss=tensor(0.4307, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   1%|▌                                                           | 276/30000 [01:40<2:43:28,  3.03it/s, loss=tensor(0.4887, device='cuda:0'), lr=0.0004]

Steps:   1%|▌                                                           | 284/30000 [01:43<2:44:01,  3.02it/s, loss=tensor(0.4329, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   1%|▌                                                           | 288/30000 [01:44<2:43:41,  3.03it/s, loss=tensor(0.4895, device='cuda:0'), lr=0.0004]

Steps:   1%|▌                                                           | 296/30000 [01:46<2:42:49,  3.04it/s, loss=tensor(0.5011, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   1%|▌                                                           | 304/30000 [01:49<2:43:01,  3.04it/s, loss=tensor(0.5885, device='cuda:0'), lr=0.0004]

Steps:   1%|▌                                                           | 308/30000 [01:50<2:42:50,  3.04it/s, loss=tensor(0.7201, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   1%|▋                                                           | 316/30000 [01:53<2:43:07,  3.03it/s, loss=tensor(0.5610, device='cuda:0'), lr=0.0004]

Steps:   1%|▋                                                           | 320/30000 [01:54<2:42:53,  3.04it/s, loss=tensor(0.6278, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   1%|▋                                                           | 328/30000 [01:57<2:42:39,  3.04it/s, loss=tensor(0.5703, device='cuda:0'), lr=0.0004]

Steps:   1%|▋                                                           | 332/30000 [01:58<2:42:39,  3.04it/s, loss=tensor(0.5912, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   1%|▋                                                           | 340/30000 [02:01<2:42:39,  3.04it/s, loss=tensor(0.5128, device='cuda:0'), lr=0.0004]

Steps:   1%|▋                                                           | 344/30000 [02:02<2:42:47,  3.04it/s, loss=tensor(0.5609, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   1%|▋                                                           | 352/30000 [02:05<2:43:22,  3.02it/s, loss=tensor(0.8305, device='cuda:0'), lr=0.0004]

Steps:   1%|▋                                                           | 356/30000 [02:06<2:44:19,  3.01it/s, loss=tensor(0.7469, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   1%|▋                                                           | 360/30000 [02:08<2:46:15,  2.97it/s, loss=tensor(0.6343, device='cuda:0'), lr=0.0004]

Steps:   1%|▋                                                           | 368/30000 [02:11<2:51:47,  2.87it/s, loss=tensor(0.5382, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   1%|▊                                                           | 376/30000 [02:13<2:46:24,  2.97it/s, loss=tensor(0.5758, device='cuda:0'), lr=0.0004]

Steps:   1%|▊                                                           | 380/30000 [02:15<2:45:05,  2.99it/s, loss=tensor(0.5462, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   1%|▊                                                           | 388/30000 [02:17<2:44:25,  3.00it/s, loss=tensor(0.6859, device='cuda:0'), lr=0.0004]

Steps:   1%|▊                                                           | 392/30000 [02:18<2:43:33,  3.02it/s, loss=tensor(0.4045, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   1%|▊                                                           | 400/30000 [02:21<2:43:56,  3.01it/s, loss=tensor(0.4114, device='cuda:0'), lr=0.0004]

Steps:   1%|▊                                                           | 404/30000 [02:22<2:43:27,  3.02it/s, loss=tensor(0.6372, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   1%|▊                                                           | 412/30000 [02:25<2:43:13,  3.02it/s, loss=tensor(0.5725, device='cuda:0'), lr=0.0004]

Steps:   1%|▊                                                           | 416/30000 [02:26<2:42:53,  3.03it/s, loss=tensor(0.4407, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   1%|▊                                                           | 424/30000 [02:29<2:43:03,  3.02it/s, loss=tensor(0.5647, device='cuda:0'), lr=0.0004]

Steps:   1%|▊                                                           | 428/30000 [02:30<2:42:58,  3.02it/s, loss=tensor(0.5572, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   1%|▊                                                           | 436/30000 [02:33<2:43:15,  3.02it/s, loss=tensor(0.6256, device='cuda:0'), lr=0.0004]

Steps:   1%|▉                                                           | 440/30000 [02:34<2:43:07,  3.02it/s, loss=tensor(0.7377, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   1%|▉                                                           | 448/30000 [02:37<2:42:55,  3.02it/s, loss=tensor(0.5208, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   2%|▉                                                           | 452/30000 [02:38<2:43:15,  3.02it/s, loss=tensor(0.5202, device='cuda:0'), lr=0.0004]

Steps:   2%|▉                                                           | 460/30000 [02:41<2:42:54,  3.02it/s, loss=tensor(0.7323, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   2%|▉                                                           | 464/30000 [02:42<2:42:26,  3.03it/s, loss=tensor(0.5527, device='cuda:0'), lr=0.0004]

Steps:   2%|▉                                                           | 472/30000 [02:45<2:41:57,  3.04it/s, loss=tensor(0.5292, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   2%|▉                                                           | 476/30000 [02:46<2:41:33,  3.05it/s, loss=tensor(0.6178, device='cuda:0'), lr=0.0004]

Steps:   2%|▉                                                           | 484/30000 [02:49<2:42:40,  3.02it/s, loss=tensor(0.6565, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   2%|▉                                                           | 488/30000 [02:50<2:42:17,  3.03it/s, loss=tensor(0.7096, device='cuda:0'), lr=0.0004]

Steps:   2%|▉                                                           | 496/30000 [02:53<2:42:54,  3.02it/s, loss=tensor(0.7356, device='cuda:0'), lr=0.0004]
model_index.json: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 537/537 [00:00<00:00, 69.8kB/s]
model_index.json:   0%|                                                                                                              | 0.00/537 [00:00<?, ?B/s]
Fetching 9 files:   0%|                                                                                                                  | 0/9 [00:00<?, ?it/s]
save weights /ssd_scratch/cvit/vaibhav/ckpts/template_truck//lora_weight_e2_s500.pt, /ssd_scratch/cvit/vaibhav/ckpts/template_truck//lora_weight_e2_s500.text_encoder.pt
Fetching 9 files: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 9/9 [00:00<00:00,  9.00it/s]
Steps:   2%|█                                                           | 500/30000 [02:57<2:42:55,  3.02it/s, loss=tensor(0.7085, device='cuda:0'), lr=0.0004]
Cross Attention is also updated!
['CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'UNetMidBlock2DCrossAttn', 'Attention', 'Attention', 'GEGLU']
['CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention']
Saving weights to /ssd_scratch/cvit/vaibhav/ckpts/template_truck//lora_weight_e2_s500.safetensors
['CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention']
Stage 1 training: Disentangling object identity first

Steps:   2%|█                                                           | 508/30000 [02:59<3:47:57,  2.16it/s, loss=tensor(0.6838, device='cuda:0'), lr=0.0004]

Steps:   2%|█                                                           | 512/30000 [03:01<3:28:16,  2.36it/s, loss=tensor(0.5538, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   2%|█                                                           | 520/30000 [03:03<3:04:50,  2.66it/s, loss=tensor(0.5146, device='cuda:0'), lr=0.0004]

Steps:   2%|█                                                           | 524/30000 [03:05<2:57:46,  2.76it/s, loss=tensor(0.5699, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   2%|█                                                           | 532/30000 [03:07<2:50:28,  2.88it/s, loss=tensor(0.5145, device='cuda:0'), lr=0.0004]

Steps:   2%|█                                                           | 536/30000 [03:09<2:47:14,  2.94it/s, loss=tensor(0.5713, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   2%|█                                                           | 540/30000 [03:10<2:48:59,  2.91it/s, loss=tensor(0.6435, device='cuda:0'), lr=0.0004]

Steps:   2%|█                                                           | 548/30000 [03:13<2:52:46,  2.84it/s, loss=tensor(0.5784, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   2%|█                                                           | 552/30000 [03:14<2:49:43,  2.89it/s, loss=tensor(0.6612, device='cuda:0'), lr=0.0004]

Steps:   2%|█                                                           | 560/30000 [03:17<2:45:18,  2.97it/s, loss=tensor(0.4415, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   2%|█▏                                                          | 564/30000 [03:18<2:44:00,  2.99it/s, loss=tensor(0.5754, device='cuda:0'), lr=0.0004]

Steps:   2%|█▏                                                          | 572/30000 [03:21<2:43:28,  3.00it/s, loss=tensor(0.4472, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   2%|█▏                                                          | 576/30000 [03:22<2:43:16,  3.00it/s, loss=tensor(0.5490, device='cuda:0'), lr=0.0004]

Steps:   2%|█▏                                                          | 584/30000 [03:25<2:42:44,  3.01it/s, loss=tensor(0.7438, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   2%|█▏                                                          | 588/30000 [03:26<2:43:47,  2.99it/s, loss=tensor(0.4967, device='cuda:0'), lr=0.0004]

Steps:   2%|█▏                                                          | 596/30000 [03:29<2:43:08,  3.00it/s, loss=tensor(0.3994, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   2%|█▏                                                          | 600/30000 [03:30<2:42:28,  3.02it/s, loss=tensor(0.4703, device='cuda:0'), lr=0.0004]

Steps:   2%|█▏                                                          | 608/30000 [03:33<2:43:23,  3.00it/s, loss=tensor(0.7628, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   2%|█▏                                                          | 616/30000 [03:35<2:42:14,  3.02it/s, loss=tensor(0.5341, device='cuda:0'), lr=0.0004]

Steps:   2%|█▏                                                          | 620/30000 [03:37<2:42:19,  3.02it/s, loss=tensor(0.5215, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   2%|█▏                                                          | 624/30000 [03:38<2:41:59,  3.02it/s, loss=tensor(0.6020, device='cuda:0'), lr=0.0004]

Steps:   2%|█▎                                                          | 632/30000 [03:41<2:41:55,  3.02it/s, loss=tensor(0.5812, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   2%|█▎                                                          | 640/30000 [03:43<2:42:46,  3.01it/s, loss=tensor(0.7005, device='cuda:0'), lr=0.0004]

Steps:   2%|█▎                                                          | 644/30000 [03:45<2:43:47,  2.99it/s, loss=tensor(0.5456, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   2%|█▎                                                          | 652/30000 [03:47<2:42:47,  3.00it/s, loss=tensor(0.6126, device='cuda:0'), lr=0.0004]

Steps:   2%|█▎                                                          | 656/30000 [03:49<2:42:40,  3.01it/s, loss=tensor(0.6788, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   2%|█▎                                                          | 664/30000 [03:51<2:42:11,  3.01it/s, loss=tensor(0.5262, device='cuda:0'), lr=0.0004]

Steps:   2%|█▎                                                          | 668/30000 [03:53<2:41:48,  3.02it/s, loss=tensor(0.6984, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   2%|█▎                                                          | 676/30000 [03:55<2:41:15,  3.03it/s, loss=tensor(0.5337, device='cuda:0'), lr=0.0004]

Steps:   2%|█▎                                                          | 680/30000 [03:57<2:41:30,  3.03it/s, loss=tensor(0.4895, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   2%|█▍                                                          | 688/30000 [03:59<2:41:35,  3.02it/s, loss=tensor(0.6648, device='cuda:0'), lr=0.0004]

Steps:   2%|█▍                                                          | 692/30000 [04:01<2:41:57,  3.02it/s, loss=tensor(0.6120, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   2%|█▍                                                          | 700/30000 [04:03<2:41:42,  3.02it/s, loss=tensor(0.6138, device='cuda:0'), lr=0.0004]

Steps:   2%|█▍                                                          | 704/30000 [04:05<2:41:27,  3.02it/s, loss=tensor(0.4996, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   2%|█▍                                                          | 712/30000 [04:07<2:41:17,  3.03it/s, loss=tensor(0.4731, device='cuda:0'), lr=0.0004]

Steps:   2%|█▍                                                          | 716/30000 [04:09<2:41:39,  3.02it/s, loss=tensor(0.6392, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   2%|█▍                                                          | 720/30000 [04:10<2:44:03,  2.97it/s, loss=tensor(0.5048, device='cuda:0'), lr=0.0004]

Steps:   2%|█▍                                                          | 728/30000 [04:13<2:49:19,  2.88it/s, loss=tensor(0.4699, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   2%|█▍                                                          | 736/30000 [04:16<2:44:43,  2.96it/s, loss=tensor(0.6014, device='cuda:0'), lr=0.0004]

Steps:   2%|█▍                                                          | 740/30000 [04:17<2:44:03,  2.97it/s, loss=tensor(0.7828, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   2%|█▍                                                          | 748/30000 [04:20<2:42:10,  3.01it/s, loss=tensor(0.5409, device='cuda:0'), lr=0.0004]

Steps:   3%|█▌                                                          | 752/30000 [04:21<2:42:47,  2.99it/s, loss=tensor(0.5726, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   3%|█▌                                                          | 760/30000 [04:24<2:43:00,  2.99it/s, loss=tensor(0.4050, device='cuda:0'), lr=0.0004]

Steps:   3%|█▌                                                          | 764/30000 [04:25<2:42:27,  3.00it/s, loss=tensor(0.7493, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   3%|█▌                                                          | 772/30000 [04:28<2:43:41,  2.98it/s, loss=tensor(0.6403, device='cuda:0'), lr=0.0004]

Steps:   3%|█▌                                                          | 776/30000 [04:29<2:42:41,  2.99it/s, loss=tensor(0.6911, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   3%|█▌                                                          | 784/30000 [04:32<2:41:52,  3.01it/s, loss=tensor(0.6013, device='cuda:0'), lr=0.0004]

Steps:   3%|█▌                                                          | 788/30000 [04:33<2:41:25,  3.02it/s, loss=tensor(0.6587, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   3%|█▌                                                          | 796/30000 [04:36<2:41:39,  3.01it/s, loss=tensor(0.6816, device='cuda:0'), lr=0.0004]

Steps:   3%|█▌                                                          | 800/30000 [04:37<2:41:34,  3.01it/s, loss=tensor(0.5377, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   3%|█▌                                                          | 808/30000 [04:40<2:41:30,  3.01it/s, loss=tensor(0.4608, device='cuda:0'), lr=0.0004]

Steps:   3%|█▌                                                          | 812/30000 [04:41<2:41:41,  3.01it/s, loss=tensor(0.4469, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   3%|█▋                                                          | 820/30000 [04:43<2:41:11,  3.02it/s, loss=tensor(0.6249, device='cuda:0'), lr=0.0004]

Steps:   3%|█▋                                                          | 824/30000 [04:45<2:41:08,  3.02it/s, loss=tensor(0.4074, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   3%|█▋                                                          | 832/30000 [04:47<2:41:04,  3.02it/s, loss=tensor(0.5491, device='cuda:0'), lr=0.0004]

Steps:   3%|█▋                                                          | 836/30000 [04:49<2:40:12,  3.03it/s, loss=tensor(0.5626, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   3%|█▋                                                          | 844/30000 [04:51<2:40:58,  3.02it/s, loss=tensor(0.6560, device='cuda:0'), lr=0.0004]

Steps:   3%|█▋                                                          | 848/30000 [04:53<2:40:50,  3.02it/s, loss=tensor(0.6506, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   3%|█▋                                                          | 856/30000 [04:55<2:41:08,  3.01it/s, loss=tensor(0.5615, device='cuda:0'), lr=0.0004]

Steps:   3%|█▋                                                          | 860/30000 [04:57<2:40:49,  3.02it/s, loss=tensor(0.6358, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   3%|█▋                                                          | 868/30000 [04:59<2:41:21,  3.01it/s, loss=tensor(0.4832, device='cuda:0'), lr=0.0004]

Steps:   3%|█▋                                                          | 872/30000 [05:01<2:40:56,  3.02it/s, loss=tensor(0.5713, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   3%|█▊                                                          | 880/30000 [05:03<2:40:24,  3.03it/s, loss=tensor(0.4628, device='cuda:0'), lr=0.0004]

Steps:   3%|█▊                                                          | 884/30000 [05:05<2:41:04,  3.01it/s, loss=tensor(0.4808, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   3%|█▊                                                          | 892/30000 [05:07<2:41:18,  3.01it/s, loss=tensor(0.6972, device='cuda:0'), lr=0.0004]

Steps:   3%|█▊                                                          | 896/30000 [05:09<2:40:26,  3.02it/s, loss=tensor(0.4857, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   3%|█▊                                                          | 904/30000 [05:12<2:53:28,  2.80it/s, loss=tensor(0.4755, device='cuda:0'), lr=0.0004]

Steps:   3%|█▊                                                          | 908/30000 [05:13<2:49:25,  2.86it/s, loss=tensor(0.4893, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   3%|█▊                                                          | 916/30000 [05:16<2:45:41,  2.93it/s, loss=tensor(0.4751, device='cuda:0'), lr=0.0004]

Steps:   3%|█▊                                                          | 920/30000 [05:17<2:44:11,  2.95it/s, loss=tensor(0.4716, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   3%|█▊                                                          | 928/30000 [05:20<2:42:41,  2.98it/s, loss=tensor(0.6530, device='cuda:0'), lr=0.0004]

Steps:   3%|█▊                                                          | 932/30000 [05:21<2:42:03,  2.99it/s, loss=tensor(0.5364, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   3%|█▉                                                          | 940/30000 [05:24<2:42:13,  2.99it/s, loss=tensor(0.4863, device='cuda:0'), lr=0.0004]

Steps:   3%|█▉                                                          | 944/30000 [05:25<2:41:46,  2.99it/s, loss=tensor(0.7302, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   3%|█▉                                                          | 952/30000 [05:28<2:40:28,  3.02it/s, loss=tensor(0.5072, device='cuda:0'), lr=0.0004]

Steps:   3%|█▉                                                          | 956/30000 [05:29<2:40:02,  3.02it/s, loss=tensor(0.7125, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   3%|█▉                                                          | 964/30000 [05:32<2:40:24,  3.02it/s, loss=tensor(0.5237, device='cuda:0'), lr=0.0004]

Steps:   3%|█▉                                                          | 968/30000 [05:33<2:40:36,  3.01it/s, loss=tensor(0.5525, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   3%|█▉                                                          | 976/30000 [05:36<2:40:27,  3.01it/s, loss=tensor(0.5354, device='cuda:0'), lr=0.0004]

Steps:   3%|█▉                                                          | 980/30000 [05:37<2:41:14,  3.00it/s, loss=tensor(0.5577, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   3%|█▉                                                          | 988/30000 [05:40<2:40:56,  3.00it/s, loss=tensor(0.5175, device='cuda:0'), lr=0.0004]

Steps:   3%|█▉                                                          | 992/30000 [05:41<2:40:51,  3.01it/s, loss=tensor(0.4950, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   3%|█▉                                                         | 1000/30000 [05:44<2:39:49,  3.02it/s, loss=tensor(0.5675, device='cuda:0'), lr=0.0004]
save weights /ssd_scratch/cvit/vaibhav/ckpts/template_truck//lora_weight_e5_s1000.pt, /ssd_scratch/cvit/vaibhav/ckpts/template_truck//lora_weight_e5_s1000.text_encoder.pt
['CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'UNetMidBlock2DCrossAttn', 'Attention', 'Attention', 'GEGLU']
Cross Attention is also updated!
['CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'UNetMidBlock2DCrossAttn', 'Attention', 'Attention', 'GEGLU']
['CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention']
Saving weights to /ssd_scratch/cvit/vaibhav/ckpts/template_truck//lora_weight_e5_s1000.safetensors
['CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention']

Steps:   3%|█▉                                                         | 1000/30000 [05:45<2:39:49,  3.02it/s, loss=tensor(0.6140, device='cuda:0'), lr=0.0004]

Steps:   3%|█▉                                                         | 1008/30000 [05:47<3:04:54,  2.61it/s, loss=tensor(0.6816, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   3%|█▉                                                         | 1016/30000 [05:50<2:52:01,  2.81it/s, loss=tensor(0.4395, device='cuda:0'), lr=0.0004]

Steps:   3%|██                                                         | 1020/30000 [05:51<2:48:36,  2.86it/s, loss=tensor(0.5519, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   3%|██                                                         | 1024/30000 [05:52<2:45:54,  2.91it/s, loss=tensor(0.5470, device='cuda:0'), lr=0.0004]

Steps:   3%|██                                                         | 1032/30000 [05:55<2:42:23,  2.97it/s, loss=tensor(0.3889, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   3%|██                                                         | 1040/30000 [05:58<2:40:38,  3.00it/s, loss=tensor(0.5740, device='cuda:0'), lr=0.0004]

Steps:   3%|██                                                         | 1044/30000 [05:59<2:40:52,  3.00it/s, loss=tensor(0.4991, device='cuda:0'), lr=0.0004]

Steps:   4%|██                                                         | 1052/30000 [06:02<2:39:34,  3.02it/s, loss=tensor(0.6723, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   4%|██                                                         | 1056/30000 [06:03<2:39:36,  3.02it/s, loss=tensor(0.4332, device='cuda:0'), lr=0.0004]

Steps:   4%|██                                                         | 1064/30000 [06:06<2:39:55,  3.02it/s, loss=tensor(0.5065, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   4%|██                                                         | 1068/30000 [06:07<2:40:23,  3.01it/s, loss=tensor(0.7252, device='cuda:0'), lr=0.0004]

Steps:   4%|██                                                         | 1076/30000 [06:10<2:40:24,  3.01it/s, loss=tensor(0.5370, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   4%|██                                                         | 1080/30000 [06:11<2:42:57,  2.96it/s, loss=tensor(0.5132, device='cuda:0'), lr=0.0004]

Steps:   4%|██▏                                                        | 1084/30000 [06:13<2:51:41,  2.81it/s, loss=tensor(0.5878, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   4%|██▏                                                        | 1092/30000 [06:16<2:51:50,  2.80it/s, loss=tensor(0.6271, device='cuda:0'), lr=0.0004]

Steps:   4%|██▏                                                        | 1096/30000 [06:17<2:47:56,  2.87it/s, loss=tensor(0.6344, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   4%|██▏                                                        | 1104/30000 [06:20<2:43:26,  2.95it/s, loss=tensor(0.5366, device='cuda:0'), lr=0.0004]

Steps:   4%|██▏                                                        | 1108/30000 [06:21<2:41:53,  2.97it/s, loss=tensor(0.5420, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   4%|██▏                                                        | 1116/30000 [06:23<2:41:06,  2.99it/s, loss=tensor(0.6649, device='cuda:0'), lr=0.0004]

Steps:   4%|██▏                                                        | 1120/30000 [06:25<2:40:25,  3.00it/s, loss=tensor(0.6069, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   4%|██▏                                                        | 1128/30000 [06:27<2:40:46,  2.99it/s, loss=tensor(0.4746, device='cuda:0'), lr=0.0004]

Steps:   4%|██▏                                                        | 1132/30000 [06:29<2:40:30,  3.00it/s, loss=tensor(0.5734, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   4%|██▏                                                        | 1140/30000 [06:31<2:39:11,  3.02it/s, loss=tensor(0.5132, device='cuda:0'), lr=0.0004]

Steps:   4%|██▏                                                        | 1144/30000 [06:33<2:38:59,  3.02it/s, loss=tensor(0.4448, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   4%|██▎                                                        | 1152/30000 [06:35<2:38:57,  3.02it/s, loss=tensor(0.5616, device='cuda:0'), lr=0.0004]

Steps:   4%|██▎                                                        | 1156/30000 [06:37<2:39:05,  3.02it/s, loss=tensor(0.6462, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   4%|██▎                                                        | 1164/30000 [06:39<2:39:05,  3.02it/s, loss=tensor(0.4436, device='cuda:0'), lr=0.0004]

Steps:   4%|██▎                                                        | 1168/30000 [06:41<2:39:44,  3.01it/s, loss=tensor(0.5718, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   4%|██▎                                                        | 1176/30000 [06:43<2:39:30,  3.01it/s, loss=tensor(0.6377, device='cuda:0'), lr=0.0004]

Steps:   4%|██▎                                                        | 1180/30000 [06:45<2:39:29,  3.01it/s, loss=tensor(0.4245, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   4%|██▎                                                        | 1188/30000 [06:47<2:38:56,  3.02it/s, loss=tensor(0.6762, device='cuda:0'), lr=0.0004]

Steps:   4%|██▎                                                        | 1196/30000 [06:50<2:39:45,  3.00it/s, loss=tensor(0.4534, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   4%|██▎                                                        | 1200/30000 [06:51<2:39:41,  3.01it/s, loss=tensor(0.6498, device='cuda:0'), lr=0.0004]

Steps:   4%|██▎                                                        | 1204/30000 [06:53<2:39:13,  3.01it/s, loss=tensor(0.6950, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   4%|██▍                                                        | 1212/30000 [06:55<2:39:42,  3.00it/s, loss=tensor(0.8142, device='cuda:0'), lr=0.0004]

Steps:   4%|██▍                                                        | 1220/30000 [06:58<2:39:46,  3.00it/s, loss=tensor(0.4531, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   4%|██▍                                                        | 1224/30000 [06:59<2:39:25,  3.01it/s, loss=tensor(0.5308, device='cuda:0'), lr=0.0004]

Steps:   4%|██▍                                                        | 1232/30000 [07:02<2:38:37,  3.02it/s, loss=tensor(0.5574, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   4%|██▍                                                        | 1236/30000 [07:03<2:38:26,  3.03it/s, loss=tensor(0.4166, device='cuda:0'), lr=0.0004]

Steps:   4%|██▍                                                        | 1244/30000 [07:06<2:38:11,  3.03it/s, loss=tensor(0.5622, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   4%|██▍                                                        | 1248/30000 [07:07<2:38:39,  3.02it/s, loss=tensor(0.5455, device='cuda:0'), lr=0.0004]

Steps:   4%|██▍                                                        | 1256/30000 [07:10<2:38:39,  3.02it/s, loss=tensor(0.5856, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   4%|██▍                                                        | 1260/30000 [07:11<2:41:29,  2.97it/s, loss=tensor(0.5265, device='cuda:0'), lr=0.0004]

Steps:   4%|██▍                                                        | 1264/30000 [07:13<2:50:32,  2.81it/s, loss=tensor(0.6337, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   4%|██▌                                                        | 1272/30000 [07:16<2:43:49,  2.92it/s, loss=tensor(0.5237, device='cuda:0'), lr=0.0004]

Steps:   4%|██▌                                                        | 1276/30000 [07:17<2:41:41,  2.96it/s, loss=tensor(0.5393, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   4%|██▌                                                        | 1284/30000 [07:19<2:39:51,  2.99it/s, loss=tensor(0.5487, device='cuda:0'), lr=0.0004]

Steps:   4%|██▌                                                        | 1288/30000 [07:21<2:39:19,  3.00it/s, loss=tensor(0.7145, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   4%|██▌                                                        | 1296/30000 [07:23<2:38:55,  3.01it/s, loss=tensor(0.4433, device='cuda:0'), lr=0.0004]

Steps:   4%|██▌                                                        | 1304/30000 [07:26<2:38:49,  3.01it/s, loss=tensor(0.7029, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   4%|██▌                                                        | 1308/30000 [07:27<2:38:46,  3.01it/s, loss=tensor(0.6170, device='cuda:0'), lr=0.0004]

Steps:   4%|██▌                                                        | 1316/30000 [07:30<2:38:15,  3.02it/s, loss=tensor(0.5229, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   4%|██▌                                                        | 1320/30000 [07:31<2:38:36,  3.01it/s, loss=tensor(0.5471, device='cuda:0'), lr=0.0004]

Steps:   4%|██▌                                                        | 1328/30000 [07:34<2:38:04,  3.02it/s, loss=tensor(0.5593, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   4%|██▌                                                        | 1332/30000 [07:35<2:38:10,  3.02it/s, loss=tensor(0.7971, device='cuda:0'), lr=0.0004]

Steps:   4%|██▋                                                        | 1340/30000 [07:38<2:38:02,  3.02it/s, loss=tensor(0.4863, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   4%|██▋                                                        | 1344/30000 [07:39<2:38:36,  3.01it/s, loss=tensor(0.6893, device='cuda:0'), lr=0.0004]

Steps:   5%|██▋                                                        | 1352/30000 [07:42<2:39:15,  3.00it/s, loss=tensor(0.4233, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   5%|██▋                                                        | 1356/30000 [07:43<2:38:39,  3.01it/s, loss=tensor(0.5187, device='cuda:0'), lr=0.0004]

Steps:   5%|██▋                                                        | 1364/30000 [07:46<2:38:37,  3.01it/s, loss=tensor(0.5365, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   5%|██▋                                                        | 1368/30000 [07:47<2:38:34,  3.01it/s, loss=tensor(0.3802, device='cuda:0'), lr=0.0004]

Steps:   5%|██▋                                                        | 1376/30000 [07:50<2:38:34,  3.01it/s, loss=tensor(0.4790, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   5%|██▋                                                        | 1380/30000 [07:51<2:38:20,  3.01it/s, loss=tensor(0.4948, device='cuda:0'), lr=0.0004]

Steps:   5%|██▋                                                        | 1388/30000 [07:54<2:38:20,  3.01it/s, loss=tensor(0.5162, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   5%|██▋                                                        | 1392/30000 [07:55<2:38:11,  3.01it/s, loss=tensor(0.6869, device='cuda:0'), lr=0.0004]

Steps:   5%|██▊                                                        | 1400/30000 [07:58<2:37:24,  3.03it/s, loss=tensor(0.5774, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   5%|██▊                                                        | 1404/30000 [07:59<2:37:18,  3.03it/s, loss=tensor(0.6317, device='cuda:0'), lr=0.0004]

Steps:   5%|██▊                                                        | 1412/30000 [08:02<2:37:41,  3.02it/s, loss=tensor(0.5949, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   5%|██▊                                                        | 1416/30000 [08:03<2:37:59,  3.02it/s, loss=tensor(0.5335, device='cuda:0'), lr=0.0004]

Steps:   5%|██▊                                                        | 1424/30000 [08:06<2:38:25,  3.01it/s, loss=tensor(0.4792, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   5%|██▊                                                        | 1428/30000 [08:07<2:38:19,  3.01it/s, loss=tensor(0.5287, device='cuda:0'), lr=0.0004]

Steps:   5%|██▊                                                        | 1436/30000 [08:10<2:37:36,  3.02it/s, loss=tensor(0.6018, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   5%|██▊                                                        | 1440/30000 [08:11<2:40:43,  2.96it/s, loss=tensor(0.5364, device='cuda:0'), lr=0.0004]

Steps:   5%|██▊                                                        | 1448/30000 [08:14<2:45:55,  2.87it/s, loss=tensor(0.4918, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   5%|██▊                                                        | 1452/30000 [08:16<2:44:33,  2.89it/s, loss=tensor(0.6147, device='cuda:0'), lr=0.0004]

Steps:   5%|██▊                                                        | 1460/30000 [08:18<2:41:11,  2.95it/s, loss=tensor(0.4252, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   5%|██▉                                                        | 1464/30000 [08:20<2:39:49,  2.98it/s, loss=tensor(0.4554, device='cuda:0'), lr=0.0004]

Steps:   5%|██▉                                                        | 1472/30000 [08:22<2:38:58,  2.99it/s, loss=tensor(0.5541, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   5%|██▉                                                        | 1476/30000 [08:24<2:38:31,  3.00it/s, loss=tensor(0.6732, device='cuda:0'), lr=0.0004]

Steps:   5%|██▉                                                        | 1484/30000 [08:26<2:38:03,  3.01it/s, loss=tensor(0.6384, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   5%|██▉                                                        | 1488/30000 [08:28<2:37:47,  3.01it/s, loss=tensor(0.5327, device='cuda:0'), lr=0.0004]

Steps:   5%|██▉                                                        | 1496/30000 [08:30<2:37:05,  3.02it/s, loss=tensor(0.5635, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   5%|██▉                                                        | 1500/30000 [08:31<2:38:00,  3.01it/s, loss=tensor(0.5635, device='cuda:0'), lr=0.0004]
save weights /ssd_scratch/cvit/vaibhav/ckpts/template_truck//lora_weight_e8_s1500.pt, /ssd_scratch/cvit/vaibhav/ckpts/template_truck//lora_weight_e8_s1500.text_encoder.pt
['CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'UNetMidBlock2DCrossAttn', 'Attention', 'Attention', 'GEGLU']
Cross Attention is also updated!

Steps:   5%|██▉                                                        | 1504/30000 [08:34<3:21:42,  2.35it/s, loss=tensor(0.7338, device='cuda:0'), lr=0.0004]
['CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention']
Saving weights to /ssd_scratch/cvit/vaibhav/ckpts/template_truck//lora_weight_e8_s1500.safetensors
['CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention']
Stage 1 training: Disentangling object identity first

Steps:   5%|██▉                                                        | 1508/30000 [08:35<3:08:09,  2.52it/s, loss=tensor(0.5317, device='cuda:0'), lr=0.0004]

Steps:   5%|██▉                                                        | 1516/30000 [08:38<2:52:16,  2.76it/s, loss=tensor(0.7704, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   5%|██▉                                                        | 1520/30000 [08:39<2:47:51,  2.83it/s, loss=tensor(0.6604, device='cuda:0'), lr=0.0004]

Steps:   5%|███                                                        | 1528/30000 [08:42<2:42:07,  2.93it/s, loss=tensor(0.4591, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   5%|███                                                        | 1532/30000 [08:43<2:40:39,  2.95it/s, loss=tensor(0.4911, device='cuda:0'), lr=0.0004]

Steps:   5%|███                                                        | 1540/30000 [08:46<2:39:59,  2.96it/s, loss=tensor(0.6216, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   5%|███                                                        | 1544/30000 [08:47<2:39:08,  2.98it/s, loss=tensor(0.5617, device='cuda:0'), lr=0.0004]

Steps:   5%|███                                                        | 1552/30000 [08:50<2:38:16,  3.00it/s, loss=tensor(0.7940, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   5%|███                                                        | 1556/30000 [08:52<2:38:09,  3.00it/s, loss=tensor(0.5975, device='cuda:0'), lr=0.0004]

Steps:   5%|███                                                        | 1564/30000 [08:54<2:42:51,  2.91it/s, loss=tensor(0.7659, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   5%|███                                                        | 1568/30000 [08:56<2:41:03,  2.94it/s, loss=tensor(0.5581, device='cuda:0'), lr=0.0004]

Steps:   5%|███                                                        | 1576/30000 [08:58<2:39:35,  2.97it/s, loss=tensor(0.5169, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   5%|███                                                        | 1580/30000 [08:59<2:38:26,  2.99it/s, loss=tensor(0.4370, device='cuda:0'), lr=0.0004]

Steps:   5%|███                                                        | 1588/30000 [09:02<2:37:46,  3.00it/s, loss=tensor(0.4936, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   5%|███▏                                                       | 1592/30000 [09:03<2:37:12,  3.01it/s, loss=tensor(0.5693, device='cuda:0'), lr=0.0004]

Steps:   5%|███▏                                                       | 1600/30000 [09:06<2:37:01,  3.01it/s, loss=tensor(0.5485, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   5%|███▏                                                       | 1604/30000 [09:07<2:37:50,  3.00it/s, loss=tensor(0.6364, device='cuda:0'), lr=0.0004]

Steps:   5%|███▏                                                       | 1612/30000 [09:10<2:37:42,  3.00it/s, loss=tensor(0.4316, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   5%|███▏                                                       | 1616/30000 [09:11<2:37:48,  3.00it/s, loss=tensor(0.6479, device='cuda:0'), lr=0.0004]

Steps:   5%|███▏                                                       | 1620/30000 [09:13<2:40:01,  2.96it/s, loss=tensor(0.6057, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   5%|███▏                                                       | 1628/30000 [09:16<2:44:46,  2.87it/s, loss=tensor(0.5448, device='cuda:0'), lr=0.0004]

Steps:   5%|███▏                                                       | 1636/30000 [09:18<2:40:21,  2.95it/s, loss=tensor(0.7595, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   5%|███▏                                                       | 1640/30000 [09:20<2:39:08,  2.97it/s, loss=tensor(0.4572, device='cuda:0'), lr=0.0004]

Steps:   5%|███▏                                                       | 1644/30000 [09:21<2:38:08,  2.99it/s, loss=tensor(0.5322, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   6%|███▏                                                       | 1652/30000 [09:24<2:37:12,  3.01it/s, loss=tensor(0.6403, device='cuda:0'), lr=0.0004]

Steps:   6%|███▎                                                       | 1656/30000 [09:25<2:36:53,  3.01it/s, loss=tensor(0.4450, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   6%|███▎                                                       | 1664/30000 [09:28<2:36:34,  3.02it/s, loss=tensor(0.6959, device='cuda:0'), lr=0.0004]

Steps:   6%|███▎                                                       | 1668/30000 [09:29<2:36:48,  3.01it/s, loss=tensor(0.5737, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   6%|███▎                                                       | 1676/30000 [09:32<2:36:35,  3.01it/s, loss=tensor(0.4221, device='cuda:0'), lr=0.0004]

Steps:   6%|███▎                                                       | 1680/30000 [09:33<2:36:55,  3.01it/s, loss=tensor(0.5490, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   6%|███▎                                                       | 1688/30000 [09:36<2:36:10,  3.02it/s, loss=tensor(0.6199, device='cuda:0'), lr=0.0004]

Steps:   6%|███▎                                                       | 1692/30000 [09:37<2:36:34,  3.01it/s, loss=tensor(0.5336, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   6%|███▎                                                       | 1700/30000 [09:40<2:35:52,  3.03it/s, loss=tensor(0.5347, device='cuda:0'), lr=0.0004]

Steps:   6%|███▎                                                       | 1704/30000 [09:41<2:36:44,  3.01it/s, loss=tensor(0.7897, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   6%|███▎                                                       | 1712/30000 [09:44<2:37:03,  3.00it/s, loss=tensor(0.8013, device='cuda:0'), lr=0.0004]

Steps:   6%|███▎                                                       | 1716/30000 [09:45<2:36:01,  3.02it/s, loss=tensor(0.5184, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   6%|███▍                                                       | 1724/30000 [09:48<2:36:38,  3.01it/s, loss=tensor(0.5916, device='cuda:0'), lr=0.0004]

Steps:   6%|███▍                                                       | 1728/30000 [09:49<2:35:54,  3.02it/s, loss=tensor(0.6410, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   6%|███▍                                                       | 1736/30000 [09:52<2:36:10,  3.02it/s, loss=tensor(0.4138, device='cuda:0'), lr=0.0004]

Steps:   6%|███▍                                                       | 1740/30000 [09:53<2:36:50,  3.00it/s, loss=tensor(0.6077, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   6%|███▍                                                       | 1748/30000 [09:56<2:36:54,  3.00it/s, loss=tensor(0.4358, device='cuda:0'), lr=0.0004]

Steps:   6%|███▍                                                       | 1752/30000 [09:57<2:36:45,  3.00it/s, loss=tensor(0.5574, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   6%|███▍                                                       | 1760/30000 [10:00<2:35:32,  3.03it/s, loss=tensor(0.3842, device='cuda:0'), lr=0.0004]

Steps:   6%|███▍                                                       | 1764/30000 [10:01<2:35:27,  3.03it/s, loss=tensor(0.5249, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   6%|███▍                                                       | 1772/30000 [10:03<2:35:16,  3.03it/s, loss=tensor(0.4929, device='cuda:0'), lr=0.0004]

Steps:   6%|███▍                                                       | 1776/30000 [10:05<2:34:58,  3.04it/s, loss=tensor(0.5397, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   6%|███▌                                                       | 1784/30000 [10:07<2:35:24,  3.03it/s, loss=tensor(0.4348, device='cuda:0'), lr=0.0004]

Steps:   6%|███▌                                                       | 1788/30000 [10:09<2:35:46,  3.02it/s, loss=tensor(0.6906, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   6%|███▌                                                       | 1796/30000 [10:11<2:34:52,  3.04it/s, loss=tensor(0.4554, device='cuda:0'), lr=0.0004]

Steps:   6%|███▌                                                       | 1800/30000 [10:13<2:38:06,  2.97it/s, loss=tensor(0.6136, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   6%|███▌                                                       | 1808/30000 [10:16<2:43:23,  2.88it/s, loss=tensor(0.5462, device='cuda:0'), lr=0.0004]

Steps:   6%|███▌                                                       | 1812/30000 [10:17<2:40:37,  2.92it/s, loss=tensor(0.5383, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   6%|███▌                                                       | 1820/30000 [10:20<2:38:08,  2.97it/s, loss=tensor(0.5611, device='cuda:0'), lr=0.0004]

Steps:   6%|███▌                                                       | 1824/30000 [10:21<2:36:56,  2.99it/s, loss=tensor(0.5192, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   6%|███▌                                                       | 1832/30000 [10:24<2:36:57,  2.99it/s, loss=tensor(0.4897, device='cuda:0'), lr=0.0004]

Steps:   6%|███▌                                                       | 1836/30000 [10:25<2:36:22,  3.00it/s, loss=tensor(0.6075, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   6%|███▋                                                       | 1844/30000 [10:28<2:35:36,  3.02it/s, loss=tensor(0.5394, device='cuda:0'), lr=0.0004]

Steps:   6%|███▋                                                       | 1848/30000 [10:29<2:35:23,  3.02it/s, loss=tensor(0.5671, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   6%|███▋                                                       | 1856/30000 [10:32<2:35:36,  3.01it/s, loss=tensor(0.4920, device='cuda:0'), lr=0.0004]

Steps:   6%|███▋                                                       | 1860/30000 [10:33<2:35:56,  3.01it/s, loss=tensor(0.5189, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   6%|███▋                                                       | 1868/30000 [10:36<2:34:56,  3.03it/s, loss=tensor(0.6108, device='cuda:0'), lr=0.0004]

Steps:   6%|███▋                                                       | 1872/30000 [10:37<2:34:45,  3.03it/s, loss=tensor(0.5255, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   6%|███▋                                                       | 1880/30000 [10:40<2:34:43,  3.03it/s, loss=tensor(0.6137, device='cuda:0'), lr=0.0004]

Steps:   6%|███▋                                                       | 1884/30000 [10:41<2:35:12,  3.02it/s, loss=tensor(0.5839, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   6%|███▋                                                       | 1892/30000 [10:44<2:36:13,  3.00it/s, loss=tensor(0.5970, device='cuda:0'), lr=0.0004]

Steps:   6%|███▋                                                       | 1896/30000 [10:45<2:35:53,  3.00it/s, loss=tensor(0.5322, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   6%|███▋                                                       | 1904/30000 [10:48<2:34:58,  3.02it/s, loss=tensor(0.6617, device='cuda:0'), lr=0.0004]

Steps:   6%|███▊                                                       | 1912/30000 [10:50<2:35:15,  3.02it/s, loss=tensor(0.6021, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   6%|███▊                                                       | 1916/30000 [10:52<2:35:09,  3.02it/s, loss=tensor(0.4958, device='cuda:0'), lr=0.0004]

Steps:   6%|███▊                                                       | 1924/30000 [10:54<2:34:55,  3.02it/s, loss=tensor(0.8868, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   6%|███▊                                                       | 1928/30000 [10:55<2:35:21,  3.01it/s, loss=tensor(0.4460, device='cuda:0'), lr=0.0004]

Steps:   6%|███▊                                                       | 1936/30000 [10:58<2:36:15,  2.99it/s, loss=tensor(0.6393, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   6%|███▊                                                       | 1940/30000 [10:59<2:35:19,  3.01it/s, loss=tensor(0.6321, device='cuda:0'), lr=0.0004]

Steps:   6%|███▊                                                       | 1948/30000 [11:02<2:36:01,  3.00it/s, loss=tensor(0.5273, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   7%|███▊                                                       | 1952/30000 [11:03<2:35:21,  3.01it/s, loss=tensor(0.5625, device='cuda:0'), lr=0.0004]

Steps:   7%|███▊                                                       | 1960/30000 [11:06<2:35:03,  3.01it/s, loss=tensor(0.6840, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   7%|███▊                                                       | 1964/30000 [11:07<2:35:15,  3.01it/s, loss=tensor(0.4591, device='cuda:0'), lr=0.0004]

Steps:   7%|███▉                                                       | 1972/30000 [11:10<2:34:44,  3.02it/s, loss=tensor(0.7064, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   7%|███▉                                                       | 1976/30000 [11:11<2:34:57,  3.01it/s, loss=tensor(0.6845, device='cuda:0'), lr=0.0004]

Steps:   7%|███▉                                                       | 1980/30000 [11:13<2:37:50,  2.96it/s, loss=tensor(0.6771, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   7%|███▉                                                       | 1988/30000 [11:16<2:43:03,  2.86it/s, loss=tensor(0.5526, device='cuda:0'), lr=0.0004]

Steps:   7%|███▉                                                       | 1992/30000 [11:17<2:40:30,  2.91it/s, loss=tensor(0.6625, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   7%|███▉                                                       | 2000/30000 [11:20<2:38:01,  2.95it/s, loss=tensor(0.6064, device='cuda:0'), lr=0.0004]
save weights /ssd_scratch/cvit/vaibhav/ckpts/template_truck//lora_weight_e11_s2000.pt, /ssd_scratch/cvit/vaibhav/ckpts/template_truck//lora_weight_e11_s2000.text_encoder.pt
['CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'UNetMidBlock2DCrossAttn', 'Attention', 'Attention', 'GEGLU']
Cross Attention is also updated!
['CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'UNetMidBlock2DCrossAttn', 'Attention', 'Attention', 'GEGLU']
['CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention']
Saving weights to /ssd_scratch/cvit/vaibhav/ckpts/template_truck//lora_weight_e11_s2000.safetensors
['CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention']

Steps:   7%|███▉                                                       | 2004/30000 [11:22<3:05:52,  2.51it/s, loss=tensor(0.5842, device='cuda:0'), lr=0.0004]

Steps:   7%|███▉                                                       | 2008/30000 [11:23<2:56:35,  2.64it/s, loss=tensor(0.5608, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   7%|███▉                                                       | 2016/30000 [11:26<2:44:42,  2.83it/s, loss=tensor(0.6273, device='cuda:0'), lr=0.0004]

Steps:   7%|███▉                                                       | 2020/30000 [11:27<2:41:14,  2.89it/s, loss=tensor(0.5943, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   7%|███▉                                                       | 2028/30000 [11:30<2:37:50,  2.95it/s, loss=tensor(0.6669, device='cuda:0'), lr=0.0004]

Steps:   7%|███▉                                                       | 2032/30000 [11:31<2:36:28,  2.98it/s, loss=tensor(0.6201, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   7%|████                                                       | 2040/30000 [11:34<2:35:20,  3.00it/s, loss=tensor(0.5341, device='cuda:0'), lr=0.0004]

Steps:   7%|████                                                       | 2044/30000 [11:35<2:35:01,  3.01it/s, loss=tensor(0.7239, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   7%|████                                                       | 2052/30000 [11:38<2:34:24,  3.02it/s, loss=tensor(0.5430, device='cuda:0'), lr=0.0004]

Steps:   7%|████                                                       | 2056/30000 [11:39<2:34:41,  3.01it/s, loss=tensor(0.5783, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   7%|████                                                       | 2064/30000 [11:42<2:34:22,  3.02it/s, loss=tensor(0.5115, device='cuda:0'), lr=0.0004]

Steps:   7%|████                                                       | 2068/30000 [11:43<2:34:39,  3.01it/s, loss=tensor(0.7478, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   7%|████                                                       | 2076/30000 [11:46<2:33:51,  3.02it/s, loss=tensor(0.4513, device='cuda:0'), lr=0.0004]

Steps:   7%|████                                                       | 2080/30000 [11:47<2:33:45,  3.03it/s, loss=tensor(0.4987, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   7%|████                                                       | 2088/30000 [11:50<2:34:00,  3.02it/s, loss=tensor(0.4845, device='cuda:0'), lr=0.0004]

Steps:   7%|████                                                       | 2092/30000 [11:51<2:34:20,  3.01it/s, loss=tensor(0.6714, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   7%|████▏                                                      | 2100/30000 [11:54<2:34:10,  3.02it/s, loss=tensor(0.6133, device='cuda:0'), lr=0.0004]

Steps:   7%|████▏                                                      | 2108/30000 [11:56<2:33:40,  3.02it/s, loss=tensor(0.4011, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   7%|████▏                                                      | 2112/30000 [11:58<2:33:27,  3.03it/s, loss=tensor(0.5570, device='cuda:0'), lr=0.0004]

Steps:   7%|████▏                                                      | 2120/30000 [12:00<2:33:45,  3.02it/s, loss=tensor(0.5925, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   7%|████▏                                                      | 2124/30000 [12:02<2:33:52,  3.02it/s, loss=tensor(0.4122, device='cuda:0'), lr=0.0004]

Steps:   7%|████▏                                                      | 2132/30000 [12:04<2:33:54,  3.02it/s, loss=tensor(0.5182, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   7%|████▏                                                      | 2136/30000 [12:06<2:34:03,  3.01it/s, loss=tensor(0.6273, device='cuda:0'), lr=0.0004]

Steps:   7%|████▏                                                      | 2144/30000 [12:08<2:33:20,  3.03it/s, loss=tensor(0.5375, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   7%|████▏                                                      | 2148/30000 [12:10<2:34:17,  3.01it/s, loss=tensor(0.5224, device='cuda:0'), lr=0.0004]

Steps:   7%|████▏                                                      | 2156/30000 [12:12<2:33:08,  3.03it/s, loss=tensor(0.5817, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   7%|████▏                                                      | 2160/30000 [12:14<2:36:08,  2.97it/s, loss=tensor(0.4013, device='cuda:0'), lr=0.0004]

Steps:   7%|████▎                                                      | 2164/30000 [12:15<2:44:52,  2.81it/s, loss=tensor(0.6036, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   7%|████▎                                                      | 2172/30000 [12:18<2:40:07,  2.90it/s, loss=tensor(0.5432, device='cuda:0'), lr=0.0004]

Steps:   7%|████▎                                                      | 2176/30000 [12:19<2:37:35,  2.94it/s, loss=tensor(0.4847, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   7%|████▎                                                      | 2184/30000 [12:22<2:35:29,  2.98it/s, loss=tensor(0.4836, device='cuda:0'), lr=0.0004]

Steps:   7%|████▎                                                      | 2188/30000 [12:23<2:35:05,  2.99it/s, loss=tensor(0.5532, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   7%|████▎                                                      | 2196/30000 [12:26<2:34:09,  3.01it/s, loss=tensor(0.5872, device='cuda:0'), lr=0.0004]

Steps:   7%|████▎                                                      | 2200/30000 [12:27<2:33:44,  3.01it/s, loss=tensor(0.5373, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   7%|████▎                                                      | 2208/30000 [12:30<2:33:42,  3.01it/s, loss=tensor(0.6135, device='cuda:0'), lr=0.0004]

Steps:   7%|████▎                                                      | 2212/30000 [12:31<2:34:07,  3.01it/s, loss=tensor(0.5693, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   7%|████▎                                                      | 2220/30000 [12:34<2:33:44,  3.01it/s, loss=tensor(0.4322, device='cuda:0'), lr=0.0004]

Steps:   7%|████▍                                                      | 2228/30000 [12:36<2:33:51,  3.01it/s, loss=tensor(0.4668, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   7%|████▍                                                      | 2232/30000 [12:38<2:33:11,  3.02it/s, loss=tensor(0.5900, device='cuda:0'), lr=0.0004]

Steps:   7%|████▍                                                      | 2240/30000 [12:40<2:33:01,  3.02it/s, loss=tensor(0.6154, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   7%|████▍                                                      | 2244/30000 [12:42<2:33:03,  3.02it/s, loss=tensor(0.5319, device='cuda:0'), lr=0.0004]

Steps:   8%|████▍                                                      | 2252/30000 [12:44<2:33:02,  3.02it/s, loss=tensor(0.5409, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   8%|████▍                                                      | 2256/30000 [12:46<2:33:10,  3.02it/s, loss=tensor(0.4639, device='cuda:0'), lr=0.0004]

Steps:   8%|████▍                                                      | 2264/30000 [12:48<2:33:48,  3.01it/s, loss=tensor(0.6237, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   8%|████▍                                                      | 2268/30000 [12:50<2:33:32,  3.01it/s, loss=tensor(0.5949, device='cuda:0'), lr=0.0004]

Steps:   8%|████▍                                                      | 2276/30000 [12:53<2:38:44,  2.91it/s, loss=tensor(0.5539, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   8%|████▍                                                      | 2280/30000 [12:54<2:36:50,  2.95it/s, loss=tensor(0.6101, device='cuda:0'), lr=0.0004]

Steps:   8%|████▍                                                      | 2288/30000 [12:57<2:34:36,  2.99it/s, loss=tensor(0.5635, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   8%|████▌                                                      | 2292/30000 [12:58<2:34:07,  3.00it/s, loss=tensor(0.5210, device='cuda:0'), lr=0.0004]

Steps:   8%|████▌                                                      | 2300/30000 [13:00<2:33:28,  3.01it/s, loss=tensor(0.6327, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   8%|████▌                                                      | 2304/30000 [13:02<2:34:00,  3.00it/s, loss=tensor(0.5821, device='cuda:0'), lr=0.0004]

Steps:   8%|████▌                                                      | 2312/30000 [13:04<2:32:54,  3.02it/s, loss=tensor(0.6254, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   8%|████▌                                                      | 2316/30000 [13:06<2:32:55,  3.02it/s, loss=tensor(0.5529, device='cuda:0'), lr=0.0004]

Steps:   8%|████▌                                                      | 2324/30000 [13:08<2:32:59,  3.02it/s, loss=tensor(0.5095, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   8%|████▌                                                      | 2328/30000 [13:10<2:32:35,  3.02it/s, loss=tensor(0.4957, device='cuda:0'), lr=0.0004]

Steps:   8%|████▌                                                      | 2336/30000 [13:12<2:31:59,  3.03it/s, loss=tensor(0.5497, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   8%|████▌                                                      | 2340/30000 [13:14<2:35:47,  2.96it/s, loss=tensor(0.7130, device='cuda:0'), lr=0.0004]

Steps:   8%|████▌                                                      | 2344/30000 [13:15<2:45:14,  2.79it/s, loss=tensor(0.5398, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   8%|████▋                                                      | 2352/30000 [13:18<2:40:00,  2.88it/s, loss=tensor(0.9024, device='cuda:0'), lr=0.0004]

Steps:   8%|████▋                                                      | 2356/30000 [13:19<2:37:30,  2.93it/s, loss=tensor(0.4860, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   8%|████▋                                                      | 2364/30000 [13:22<2:35:45,  2.96it/s, loss=tensor(0.6279, device='cuda:0'), lr=0.0004]

Steps:   8%|████▋                                                      | 2368/30000 [13:23<2:34:35,  2.98it/s, loss=tensor(0.6616, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   8%|████▋                                                      | 2376/30000 [13:26<2:33:53,  2.99it/s, loss=tensor(0.7568, device='cuda:0'), lr=0.0004]

Steps:   8%|████▋                                                      | 2380/30000 [13:27<2:33:38,  3.00it/s, loss=tensor(0.4094, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   8%|████▋                                                      | 2388/30000 [13:30<2:33:45,  2.99it/s, loss=tensor(0.6241, device='cuda:0'), lr=0.0004]

Steps:   8%|████▋                                                      | 2392/30000 [13:31<2:34:11,  2.98it/s, loss=tensor(0.6596, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   8%|████▋                                                      | 2400/30000 [13:34<2:33:39,  2.99it/s, loss=tensor(0.5094, device='cuda:0'), lr=0.0004]

Steps:   8%|████▋                                                      | 2404/30000 [13:35<2:33:04,  3.00it/s, loss=tensor(0.4013, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   8%|████▋                                                      | 2412/30000 [13:38<2:33:13,  3.00it/s, loss=tensor(0.7549, device='cuda:0'), lr=0.0004]

Steps:   8%|████▊                                                      | 2416/30000 [13:39<2:32:36,  3.01it/s, loss=tensor(0.5793, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   8%|████▊                                                      | 2424/30000 [13:42<2:32:24,  3.02it/s, loss=tensor(0.5251, device='cuda:0'), lr=0.0004]

Steps:   8%|████▊                                                      | 2428/30000 [13:43<2:31:54,  3.02it/s, loss=tensor(0.4536, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   8%|████▊                                                      | 2436/30000 [13:46<2:32:12,  3.02it/s, loss=tensor(0.5321, device='cuda:0'), lr=0.0004]

Steps:   8%|████▊                                                      | 2440/30000 [13:47<2:32:38,  3.01it/s, loss=tensor(0.5227, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   8%|████▊                                                      | 2448/30000 [13:50<2:33:08,  3.00it/s, loss=tensor(0.4014, device='cuda:0'), lr=0.0004]

Steps:   8%|████▊                                                      | 2452/30000 [13:51<2:33:23,  2.99it/s, loss=tensor(0.5229, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   8%|████▊                                                      | 2460/30000 [13:54<2:33:04,  3.00it/s, loss=tensor(0.4953, device='cuda:0'), lr=0.0004]

Steps:   8%|████▊                                                      | 2468/30000 [13:57<2:32:14,  3.01it/s, loss=tensor(0.6989, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   8%|████▊                                                      | 2472/30000 [13:58<2:32:12,  3.01it/s, loss=tensor(0.5009, device='cuda:0'), lr=0.0004]

Steps:   8%|████▉                                                      | 2480/30000 [14:01<2:32:09,  3.01it/s, loss=tensor(0.6977, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   8%|████▉                                                      | 2484/30000 [14:02<2:31:44,  3.02it/s, loss=tensor(0.5943, device='cuda:0'), lr=0.0004]

Steps:   8%|████▉                                                      | 2492/30000 [14:05<2:32:47,  3.00it/s, loss=tensor(0.5542, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   8%|████▉                                                      | 2496/30000 [14:06<2:32:13,  3.01it/s, loss=tensor(0.6887, device='cuda:0'), lr=0.0004]

Steps:   8%|████▉                                                      | 2500/30000 [14:08<2:32:06,  3.01it/s, loss=tensor(0.4345, device='cuda:0'), lr=0.0004]
save weights /ssd_scratch/cvit/vaibhav/ckpts/template_truck//lora_weight_e13_s2500.pt, /ssd_scratch/cvit/vaibhav/ckpts/template_truck//lora_weight_e13_s2500.text_encoder.pt
['CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'UNetMidBlock2DCrossAttn', 'Attention', 'Attention', 'GEGLU']
Cross Attention is also updated!
['CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'UNetMidBlock2DCrossAttn', 'Attention', 'Attention', 'GEGLU']
['CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention']
Saving weights to /ssd_scratch/cvit/vaibhav/ckpts/template_truck//lora_weight_e13_s2500.safetensors
['CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention']

Steps:   8%|████▉                                                      | 2504/30000 [14:10<3:01:18,  2.53it/s, loss=tensor(0.5343, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   8%|████▉                                                      | 2512/30000 [14:12<2:46:13,  2.76it/s, loss=tensor(0.5883, device='cuda:0'), lr=0.0004]

Steps:   8%|████▉                                                      | 2516/30000 [14:14<2:42:12,  2.82it/s, loss=tensor(0.5899, device='cuda:0'), lr=0.0004]

Steps:   8%|████▉                                                      | 2524/30000 [14:17<2:48:42,  2.71it/s, loss=tensor(0.3781, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   8%|████▉                                                      | 2528/30000 [14:18<2:43:37,  2.80it/s, loss=tensor(0.4515, device='cuda:0'), lr=0.0004]

Steps:   8%|████▉                                                      | 2536/30000 [14:20<2:37:24,  2.91it/s, loss=tensor(0.4826, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   8%|████▉                                                      | 2540/30000 [14:22<2:36:15,  2.93it/s, loss=tensor(0.5641, device='cuda:0'), lr=0.0004]

Steps:   8%|█████                                                      | 2548/30000 [14:24<2:33:35,  2.98it/s, loss=tensor(0.4368, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   9%|█████                                                      | 2552/30000 [14:26<2:33:11,  2.99it/s, loss=tensor(0.4782, device='cuda:0'), lr=0.0004]

Steps:   9%|█████                                                      | 2560/30000 [14:28<2:32:44,  2.99it/s, loss=tensor(0.5996, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   9%|█████                                                      | 2564/30000 [14:30<2:32:22,  3.00it/s, loss=tensor(0.5915, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   9%|█████                                                      | 2572/30000 [14:32<2:31:36,  3.02it/s, loss=tensor(0.6858, device='cuda:0'), lr=0.0004]

Steps:   9%|█████                                                      | 2576/30000 [14:34<2:31:17,  3.02it/s, loss=tensor(0.7016, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   9%|█████                                                      | 2584/30000 [14:36<2:31:58,  3.01it/s, loss=tensor(0.5666, device='cuda:0'), lr=0.0004]

Steps:   9%|█████                                                      | 2588/30000 [14:38<2:31:35,  3.01it/s, loss=tensor(0.6168, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   9%|█████                                                      | 2596/30000 [14:40<2:32:02,  3.00it/s, loss=tensor(0.6293, device='cuda:0'), lr=0.0004]

Steps:   9%|█████                                                      | 2600/30000 [14:42<2:32:21,  3.00it/s, loss=tensor(0.6064, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   9%|█████▏                                                     | 2608/30000 [14:44<2:32:03,  3.00it/s, loss=tensor(0.6102, device='cuda:0'), lr=0.0004]

Steps:   9%|█████▏                                                     | 2612/30000 [14:46<2:31:32,  3.01it/s, loss=tensor(0.4256, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   9%|█████▏                                                     | 2620/30000 [14:48<2:32:36,  2.99it/s, loss=tensor(0.6010, device='cuda:0'), lr=0.0004]

Steps:   9%|█████▏                                                     | 2624/30000 [14:50<2:32:06,  3.00it/s, loss=tensor(0.6286, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   9%|█████▏                                                     | 2632/30000 [14:52<2:31:49,  3.00it/s, loss=tensor(0.4855, device='cuda:0'), lr=0.0004]

Steps:   9%|█████▏                                                     | 2636/30000 [14:54<2:33:28,  2.97it/s, loss=tensor(0.7512, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   9%|█████▏                                                     | 2644/30000 [14:56<2:31:58,  3.00it/s, loss=tensor(0.5234, device='cuda:0'), lr=0.0004]

Steps:   9%|█████▏                                                     | 2648/30000 [14:58<2:31:54,  3.00it/s, loss=tensor(0.5305, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   9%|█████▏                                                     | 2656/30000 [15:00<2:31:40,  3.00it/s, loss=tensor(0.4490, device='cuda:0'), lr=0.0004]

Steps:   9%|█████▏                                                     | 2660/30000 [15:02<2:31:08,  3.01it/s, loss=tensor(0.5228, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   9%|█████▏                                                     | 2668/30000 [15:04<2:30:48,  3.02it/s, loss=tensor(0.4147, device='cuda:0'), lr=0.0004]

Steps:   9%|█████▎                                                     | 2672/30000 [15:06<2:30:56,  3.02it/s, loss=tensor(0.5486, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   9%|█████▎                                                     | 2680/30000 [15:08<2:30:41,  3.02it/s, loss=tensor(0.6573, device='cuda:0'), lr=0.0004]

Steps:   9%|█████▎                                                     | 2684/30000 [15:10<2:30:55,  3.02it/s, loss=tensor(0.6569, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   9%|█████▎                                                     | 2692/30000 [15:12<2:31:19,  3.01it/s, loss=tensor(0.4842, device='cuda:0'), lr=0.0004]

Steps:   9%|█████▎                                                     | 2696/30000 [15:14<2:31:55,  3.00it/s, loss=tensor(0.5198, device='cuda:0'), lr=0.0004]

Steps:   9%|█████▎                                                     | 2704/30000 [15:17<2:43:44,  2.78it/s, loss=tensor(0.4538, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   9%|█████▎                                                     | 2708/30000 [15:18<2:39:35,  2.85it/s, loss=tensor(0.6367, device='cuda:0'), lr=0.0004]

Steps:   9%|█████▎                                                     | 2716/30000 [15:21<2:35:03,  2.93it/s, loss=tensor(0.6544, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   9%|█████▎                                                     | 2720/30000 [15:22<2:34:31,  2.94it/s, loss=tensor(0.4778, device='cuda:0'), lr=0.0004]

Steps:   9%|█████▎                                                     | 2728/30000 [15:25<2:32:57,  2.97it/s, loss=tensor(0.3969, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   9%|█████▎                                                     | 2732/30000 [15:26<2:31:59,  2.99it/s, loss=tensor(0.4616, device='cuda:0'), lr=0.0004]

Steps:   9%|█████▍                                                     | 2740/30000 [15:29<2:31:13,  3.00it/s, loss=tensor(0.6352, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   9%|█████▍                                                     | 2744/30000 [15:30<2:31:09,  3.01it/s, loss=tensor(0.7392, device='cuda:0'), lr=0.0004]

Steps:   9%|█████▍                                                     | 2752/30000 [15:33<2:30:33,  3.02it/s, loss=tensor(0.4761, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   9%|█████▍                                                     | 2756/30000 [15:34<2:30:46,  3.01it/s, loss=tensor(0.4122, device='cuda:0'), lr=0.0004]

Steps:   9%|█████▍                                                     | 2764/30000 [15:37<2:30:29,  3.02it/s, loss=tensor(0.7395, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   9%|█████▍                                                     | 2768/30000 [15:38<2:30:40,  3.01it/s, loss=tensor(0.7026, device='cuda:0'), lr=0.0004]

Steps:   9%|█████▍                                                     | 2776/30000 [15:41<2:30:11,  3.02it/s, loss=tensor(0.7483, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   9%|█████▍                                                     | 2780/30000 [15:42<2:30:45,  3.01it/s, loss=tensor(0.7497, device='cuda:0'), lr=0.0004]

Steps:   9%|█████▍                                                     | 2788/30000 [15:45<2:30:00,  3.02it/s, loss=tensor(0.5238, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   9%|█████▍                                                     | 2792/30000 [15:46<2:29:53,  3.03it/s, loss=tensor(0.5776, device='cuda:0'), lr=0.0004]

Steps:   9%|█████▌                                                     | 2800/30000 [15:49<2:29:59,  3.02it/s, loss=tensor(0.5108, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   9%|█████▌                                                     | 2804/30000 [15:50<2:30:04,  3.02it/s, loss=tensor(0.4571, device='cuda:0'), lr=0.0004]

Steps:   9%|█████▌                                                     | 2812/30000 [15:53<2:30:32,  3.01it/s, loss=tensor(0.6096, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   9%|█████▌                                                     | 2816/30000 [15:54<2:30:18,  3.01it/s, loss=tensor(0.4937, device='cuda:0'), lr=0.0004]

Steps:   9%|█████▌                                                     | 2824/30000 [15:57<2:30:20,  3.01it/s, loss=tensor(0.5282, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   9%|█████▌                                                     | 2828/30000 [15:58<2:29:56,  3.02it/s, loss=tensor(0.4561, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   9%|█████▌                                                     | 2836/30000 [16:01<2:30:19,  3.01it/s, loss=tensor(0.5069, device='cuda:0'), lr=0.0004]

Steps:   9%|█████▌                                                     | 2840/30000 [16:02<2:30:58,  3.00it/s, loss=tensor(0.6480, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:   9%|█████▌                                                     | 2848/30000 [16:05<2:30:24,  3.01it/s, loss=tensor(0.6048, device='cuda:0'), lr=0.0004]

Steps:  10%|█████▌                                                     | 2852/30000 [16:06<2:30:11,  3.01it/s, loss=tensor(0.6773, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  10%|█████▌                                                     | 2860/30000 [16:09<2:29:29,  3.03it/s, loss=tensor(0.4054, device='cuda:0'), lr=0.0004]

Steps:  10%|█████▋                                                     | 2864/30000 [16:10<2:29:40,  3.02it/s, loss=tensor(0.5037, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  10%|█████▋                                                     | 2872/30000 [16:12<2:29:53,  3.02it/s, loss=tensor(0.6523, device='cuda:0'), lr=0.0004]

Steps:  10%|█████▋                                                     | 2876/30000 [16:14<2:29:18,  3.03it/s, loss=tensor(0.5563, device='cuda:0'), lr=0.0004]

Steps:  10%|█████▋                                                     | 2884/30000 [16:17<2:40:56,  2.81it/s, loss=tensor(0.6441, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  10%|█████▋                                                     | 2888/30000 [16:18<2:38:06,  2.86it/s, loss=tensor(0.4084, device='cuda:0'), lr=0.0004]

Steps:  10%|█████▋                                                     | 2896/30000 [16:21<2:33:35,  2.94it/s, loss=tensor(0.6539, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  10%|█████▋                                                     | 2900/30000 [16:22<2:32:55,  2.95it/s, loss=tensor(0.5177, device='cuda:0'), lr=0.0004]

Steps:  10%|█████▋                                                     | 2908/30000 [16:25<2:31:00,  2.99it/s, loss=tensor(0.5916, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  10%|█████▋                                                     | 2912/30000 [16:26<2:30:25,  3.00it/s, loss=tensor(0.5148, device='cuda:0'), lr=0.0004]

Steps:  10%|█████▋                                                     | 2920/30000 [16:29<2:29:51,  3.01it/s, loss=tensor(0.5091, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  10%|█████▊                                                     | 2924/30000 [16:30<2:30:11,  3.00it/s, loss=tensor(0.5835, device='cuda:0'), lr=0.0004]

Steps:  10%|█████▊                                                     | 2932/30000 [16:33<2:29:22,  3.02it/s, loss=tensor(0.5640, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  10%|█████▊                                                     | 2936/30000 [16:34<2:29:19,  3.02it/s, loss=tensor(0.7561, device='cuda:0'), lr=0.0004]

Steps:  10%|█████▊                                                     | 2944/30000 [16:37<2:30:00,  3.01it/s, loss=tensor(0.6302, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  10%|█████▊                                                     | 2948/30000 [16:38<2:30:07,  3.00it/s, loss=tensor(0.5161, device='cuda:0'), lr=0.0004]

Steps:  10%|█████▊                                                     | 2956/30000 [16:41<2:30:01,  3.00it/s, loss=tensor(0.5161, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  10%|█████▊                                                     | 2960/30000 [16:42<2:29:54,  3.01it/s, loss=tensor(0.6176, device='cuda:0'), lr=0.0004]

Steps:  10%|█████▊                                                     | 2968/30000 [16:45<2:29:05,  3.02it/s, loss=tensor(0.4930, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  10%|█████▊                                                     | 2972/30000 [16:46<2:29:09,  3.02it/s, loss=tensor(0.5081, device='cuda:0'), lr=0.0004]

Steps:  10%|█████▊                                                     | 2980/30000 [16:49<2:29:47,  3.01it/s, loss=tensor(0.4644, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  10%|█████▊                                                     | 2984/30000 [16:50<2:29:32,  3.01it/s, loss=tensor(0.5072, device='cuda:0'), lr=0.0004]

Steps:  10%|█████▉                                                     | 2992/30000 [16:53<2:29:54,  3.00it/s, loss=tensor(0.6539, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  10%|█████▉                                                     | 2996/30000 [16:54<2:29:18,  3.01it/s, loss=tensor(0.5870, device='cuda:0'), lr=0.0004]

Steps:  10%|█████▉                                                     | 3000/30000 [16:57<2:29:19,  3.01it/s, loss=tensor(0.6587, device='cuda:0'), lr=0.0004]
save weights /ssd_scratch/cvit/vaibhav/ckpts/template_truck//lora_weight_e16_s3000.pt, /ssd_scratch/cvit/vaibhav/ckpts/template_truck//lora_weight_e16_s3000.text_encoder.pt
['CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'UNetMidBlock2DCrossAttn', 'Attention', 'Attention', 'GEGLU']
Cross Attention is also updated!
['CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'UNetMidBlock2DCrossAttn', 'Attention', 'Attention', 'GEGLU']
['CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention']
Saving weights to /ssd_scratch/cvit/vaibhav/ckpts/template_truck//lora_weight_e16_s3000.safetensors
['CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention']

Steps:  10%|█████▉                                                     | 3004/30000 [16:58<3:14:16,  2.32it/s, loss=tensor(0.5718, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  10%|█████▉                                                     | 3012/30000 [17:01<2:51:40,  2.62it/s, loss=tensor(0.6572, device='cuda:0'), lr=0.0004]

Steps:  10%|█████▉                                                     | 3016/30000 [17:02<2:45:10,  2.72it/s, loss=tensor(0.4624, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  10%|█████▉                                                     | 3024/30000 [17:05<2:36:49,  2.87it/s, loss=tensor(0.5884, device='cuda:0'), lr=0.0004]

Steps:  10%|█████▉                                                     | 3028/30000 [17:06<2:34:34,  2.91it/s, loss=tensor(0.6145, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  10%|█████▉                                                     | 3036/30000 [17:09<2:32:26,  2.95it/s, loss=tensor(0.5099, device='cuda:0'), lr=0.0004]

Steps:  10%|█████▉                                                     | 3040/30000 [17:10<2:31:26,  2.97it/s, loss=tensor(0.7190, device='cuda:0'), lr=0.0004]

Steps:  10%|█████▉                                                     | 3048/30000 [17:13<2:35:05,  2.90it/s, loss=tensor(0.6170, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  10%|██████                                                     | 3052/30000 [17:14<2:33:12,  2.93it/s, loss=tensor(0.4364, device='cuda:0'), lr=0.0004]

Steps:  10%|██████                                                     | 3060/30000 [17:17<2:33:41,  2.92it/s, loss=tensor(0.4552, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  10%|██████                                                     | 3064/30000 [17:19<2:46:33,  2.70it/s, loss=tensor(0.5631, device='cuda:0'), lr=0.0004]

Steps:  10%|██████                                                     | 3072/30000 [17:21<2:37:19,  2.85it/s, loss=tensor(0.5093, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  10%|██████                                                     | 3076/30000 [17:23<2:35:14,  2.89it/s, loss=tensor(0.4715, device='cuda:0'), lr=0.0004]

Steps:  10%|██████                                                     | 3084/30000 [17:25<2:32:47,  2.94it/s, loss=tensor(0.4097, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  10%|██████                                                     | 3088/30000 [17:27<2:31:05,  2.97it/s, loss=tensor(0.4871, device='cuda:0'), lr=0.0004]

Steps:  10%|██████                                                     | 3096/30000 [17:29<2:30:00,  2.99it/s, loss=tensor(0.5259, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  10%|██████                                                     | 3100/30000 [17:31<2:30:28,  2.98it/s, loss=tensor(0.5062, device='cuda:0'), lr=0.0004]

Steps:  10%|██████                                                     | 3108/30000 [17:33<2:29:47,  2.99it/s, loss=tensor(0.4661, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  10%|██████                                                     | 3112/30000 [17:35<2:29:27,  3.00it/s, loss=tensor(0.6437, device='cuda:0'), lr=0.0004]

Steps:  10%|██████▏                                                    | 3120/30000 [17:37<2:28:54,  3.01it/s, loss=tensor(0.5531, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  10%|██████▏                                                    | 3124/30000 [17:39<2:28:37,  3.01it/s, loss=tensor(0.5679, device='cuda:0'), lr=0.0004]

Steps:  10%|██████▏                                                    | 3132/30000 [17:41<2:28:41,  3.01it/s, loss=tensor(0.6298, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  10%|██████▏                                                    | 3136/30000 [17:43<2:28:32,  3.01it/s, loss=tensor(0.4290, device='cuda:0'), lr=0.0004]

Steps:  10%|██████▏                                                    | 3144/30000 [17:45<2:29:06,  3.00it/s, loss=tensor(0.5569, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  10%|██████▏                                                    | 3148/30000 [17:47<2:29:28,  2.99it/s, loss=tensor(0.6855, device='cuda:0'), lr=0.0004]

Steps:  11%|██████▏                                                    | 3156/30000 [17:49<2:28:26,  3.01it/s, loss=tensor(0.4207, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  11%|██████▏                                                    | 3160/30000 [17:51<2:28:26,  3.01it/s, loss=tensor(0.6587, device='cuda:0'), lr=0.0004]

Steps:  11%|██████▏                                                    | 3168/30000 [17:53<2:28:38,  3.01it/s, loss=tensor(0.6994, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  11%|██████▏                                                    | 3172/30000 [17:55<2:29:10,  3.00it/s, loss=tensor(0.5329, device='cuda:0'), lr=0.0004]

Steps:  11%|██████▎                                                    | 3180/30000 [17:57<2:28:13,  3.02it/s, loss=tensor(0.6881, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  11%|██████▎                                                    | 3184/30000 [17:58<2:28:12,  3.02it/s, loss=tensor(0.4048, device='cuda:0'), lr=0.0004]

Steps:  11%|██████▎                                                    | 3192/30000 [18:01<2:27:51,  3.02it/s, loss=tensor(0.6219, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  11%|██████▎                                                    | 3196/30000 [18:02<2:27:23,  3.03it/s, loss=tensor(0.4714, device='cuda:0'), lr=0.0004]

Steps:  11%|██████▎                                                    | 3204/30000 [18:05<2:27:40,  3.02it/s, loss=tensor(0.3762, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  11%|██████▎                                                    | 3208/30000 [18:06<2:27:58,  3.02it/s, loss=tensor(0.4962, device='cuda:0'), lr=0.0004]

Steps:  11%|██████▎                                                    | 3216/30000 [18:09<2:28:41,  3.00it/s, loss=tensor(0.7280, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  11%|██████▎                                                    | 3220/30000 [18:10<2:28:09,  3.01it/s, loss=tensor(0.5555, device='cuda:0'), lr=0.0004]

Steps:  11%|██████▎                                                    | 3228/30000 [18:13<2:28:51,  3.00it/s, loss=tensor(0.5015, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  11%|██████▎                                                    | 3232/30000 [18:14<2:28:25,  3.01it/s, loss=tensor(0.5732, device='cuda:0'), lr=0.0004]

Steps:  11%|██████▎                                                    | 3240/30000 [18:17<2:30:47,  2.96it/s, loss=tensor(0.6241, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  11%|██████▍                                                    | 3244/30000 [18:19<2:38:49,  2.81it/s, loss=tensor(0.5826, device='cuda:0'), lr=0.0004]

Steps:  11%|██████▍                                                    | 3252/30000 [18:21<2:32:56,  2.91it/s, loss=tensor(0.7845, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  11%|██████▍                                                    | 3256/30000 [18:23<2:31:50,  2.94it/s, loss=tensor(0.4984, device='cuda:0'), lr=0.0004]

Steps:  11%|██████▍                                                    | 3264/30000 [18:25<2:30:06,  2.97it/s, loss=tensor(0.4680, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  11%|██████▍                                                    | 3268/30000 [18:27<2:29:44,  2.98it/s, loss=tensor(0.5385, device='cuda:0'), lr=0.0004]

Steps:  11%|██████▍                                                    | 3276/30000 [18:29<2:28:34,  3.00it/s, loss=tensor(0.6879, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  11%|██████▍                                                    | 3280/30000 [18:31<2:28:31,  3.00it/s, loss=tensor(0.7028, device='cuda:0'), lr=0.0004]

Steps:  11%|██████▍                                                    | 3288/30000 [18:33<2:27:48,  3.01it/s, loss=tensor(0.5632, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  11%|██████▍                                                    | 3292/30000 [18:35<2:28:01,  3.01it/s, loss=tensor(0.6198, device='cuda:0'), lr=0.0004]

Steps:  11%|██████▍                                                    | 3300/30000 [18:37<2:28:05,  3.00it/s, loss=tensor(0.5628, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  11%|██████▍                                                    | 3304/30000 [18:39<2:27:18,  3.02it/s, loss=tensor(0.7398, device='cuda:0'), lr=0.0004]

Steps:  11%|██████▌                                                    | 3312/30000 [18:41<2:27:17,  3.02it/s, loss=tensor(0.6556, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  11%|██████▌                                                    | 3316/30000 [18:43<2:27:25,  3.02it/s, loss=tensor(0.5186, device='cuda:0'), lr=0.0004]

Steps:  11%|██████▌                                                    | 3324/30000 [18:45<2:28:07,  3.00it/s, loss=tensor(0.4792, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  11%|██████▌                                                    | 3328/30000 [18:47<2:27:20,  3.02it/s, loss=tensor(0.6214, device='cuda:0'), lr=0.0004]

Steps:  11%|██████▌                                                    | 3336/30000 [18:49<2:27:32,  3.01it/s, loss=tensor(0.6244, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  11%|██████▌                                                    | 3340/30000 [18:51<2:27:42,  3.01it/s, loss=tensor(0.5587, device='cuda:0'), lr=0.0004]

Steps:  11%|██████▌                                                    | 3348/30000 [18:53<2:27:08,  3.02it/s, loss=tensor(0.4716, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  11%|██████▌                                                    | 3352/30000 [18:55<2:27:37,  3.01it/s, loss=tensor(0.6787, device='cuda:0'), lr=0.0004]

Steps:  11%|██████▌                                                    | 3360/30000 [18:57<2:28:02,  3.00it/s, loss=tensor(0.4645, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  11%|██████▌                                                    | 3364/30000 [18:59<2:28:13,  3.00it/s, loss=tensor(0.6441, device='cuda:0'), lr=0.0004]

Steps:  11%|██████▋                                                    | 3372/30000 [19:01<2:27:26,  3.01it/s, loss=tensor(0.4134, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  11%|██████▋                                                    | 3376/30000 [19:03<2:27:34,  3.01it/s, loss=tensor(0.7652, device='cuda:0'), lr=0.0004]

Steps:  11%|██████▋                                                    | 3384/30000 [19:05<2:27:23,  3.01it/s, loss=tensor(0.4802, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  11%|██████▋                                                    | 3388/30000 [19:07<2:27:32,  3.01it/s, loss=tensor(0.6251, device='cuda:0'), lr=0.0004]

Steps:  11%|██████▋                                                    | 3396/30000 [19:09<2:27:06,  3.01it/s, loss=tensor(0.3903, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  11%|██████▋                                                    | 3400/30000 [19:11<2:27:02,  3.01it/s, loss=tensor(0.5705, device='cuda:0'), lr=0.0004]

Steps:  11%|██████▋                                                    | 3408/30000 [19:13<2:27:00,  3.01it/s, loss=tensor(0.7077, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  11%|██████▋                                                    | 3412/30000 [19:15<2:26:52,  3.02it/s, loss=tensor(0.6507, device='cuda:0'), lr=0.0004]

Steps:  11%|██████▋                                                    | 3416/30000 [19:16<2:26:31,  3.02it/s, loss=tensor(0.4887, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  11%|██████▋                                                    | 3424/30000 [19:19<2:37:15,  2.82it/s, loss=tensor(0.5580, device='cuda:0'), lr=0.0004]

Steps:  11%|██████▋                                                    | 3428/30000 [19:20<2:34:07,  2.87it/s, loss=tensor(0.4128, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  11%|██████▊                                                    | 3436/30000 [19:23<2:30:10,  2.95it/s, loss=tensor(0.6019, device='cuda:0'), lr=0.0004]

Steps:  11%|██████▊                                                    | 3440/30000 [19:24<2:30:04,  2.95it/s, loss=tensor(0.4890, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  11%|██████▊                                                    | 3448/30000 [19:27<2:27:59,  2.99it/s, loss=tensor(0.7178, device='cuda:0'), lr=0.0004]

Steps:  12%|██████▊                                                    | 3452/30000 [19:28<2:27:05,  3.01it/s, loss=tensor(0.4554, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  12%|██████▊                                                    | 3460/30000 [19:31<2:27:10,  3.01it/s, loss=tensor(0.6055, device='cuda:0'), lr=0.0004]

Steps:  12%|██████▊                                                    | 3464/30000 [19:32<2:26:56,  3.01it/s, loss=tensor(0.6669, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  12%|██████▊                                                    | 3472/30000 [19:35<2:26:49,  3.01it/s, loss=tensor(0.4932, device='cuda:0'), lr=0.0004]

Steps:  12%|██████▊                                                    | 3476/30000 [19:36<2:26:59,  3.01it/s, loss=tensor(0.6582, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  12%|██████▊                                                    | 3484/30000 [19:39<2:26:51,  3.01it/s, loss=tensor(0.6071, device='cuda:0'), lr=0.0004]

Steps:  12%|██████▊                                                    | 3488/30000 [19:40<2:26:31,  3.02it/s, loss=tensor(0.4222, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  12%|██████▉                                                    | 3496/30000 [19:43<2:29:48,  2.95it/s, loss=tensor(0.6792, device='cuda:0'), lr=0.0004]

Steps:  12%|██████▉                                                    | 3500/30000 [19:44<2:28:34,  2.97it/s, loss=tensor(0.6792, device='cuda:0'), lr=0.0004]
save weights /ssd_scratch/cvit/vaibhav/ckpts/template_truck//lora_weight_e19_s3500.pt, /ssd_scratch/cvit/vaibhav/ckpts/template_truck//lora_weight_e19_s3500.text_encoder.pt
['CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'UNetMidBlock2DCrossAttn', 'Attention', 'Attention', 'GEGLU']
Cross Attention is also updated!

Steps:  12%|██████▉                                                    | 3500/30000 [19:46<2:28:34,  2.97it/s, loss=tensor(0.4193, device='cuda:0'), lr=0.0004]
['CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention']
Saving weights to /ssd_scratch/cvit/vaibhav/ckpts/template_truck//lora_weight_e19_s3500.safetensors
['CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention']
Stage 1 training: Disentangling object identity first

Steps:  12%|██████▉                                                    | 3508/30000 [19:49<3:06:49,  2.36it/s, loss=tensor(0.6142, device='cuda:0'), lr=0.0004]

Steps:  12%|██████▉                                                    | 3516/30000 [19:51<2:46:17,  2.65it/s, loss=tensor(0.5156, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  12%|██████▉                                                    | 3520/30000 [19:53<2:40:17,  2.75it/s, loss=tensor(0.4674, device='cuda:0'), lr=0.0004]

Steps:  12%|██████▉                                                    | 3528/30000 [19:55<2:32:49,  2.89it/s, loss=tensor(0.4811, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  12%|██████▉                                                    | 3532/30000 [19:57<2:30:32,  2.93it/s, loss=tensor(0.4388, device='cuda:0'), lr=0.0004]

Steps:  12%|██████▉                                                    | 3540/30000 [19:59<2:28:16,  2.97it/s, loss=tensor(0.4023, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  12%|██████▉                                                    | 3544/30000 [20:00<2:27:42,  2.99it/s, loss=tensor(0.5181, device='cuda:0'), lr=0.0004]

Steps:  12%|██████▉                                                    | 3552/30000 [20:03<2:27:44,  2.98it/s, loss=tensor(0.6403, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  12%|██████▉                                                    | 3556/30000 [20:04<2:27:24,  2.99it/s, loss=tensor(0.8509, device='cuda:0'), lr=0.0004]

Steps:  12%|███████                                                    | 3564/30000 [20:07<2:26:27,  3.01it/s, loss=tensor(0.7204, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  12%|███████                                                    | 3568/30000 [20:08<2:26:15,  3.01it/s, loss=tensor(0.5689, device='cuda:0'), lr=0.0004]

Steps:  12%|███████                                                    | 3576/30000 [20:11<2:25:34,  3.03it/s, loss=tensor(0.5661, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  12%|███████                                                    | 3580/30000 [20:12<2:25:55,  3.02it/s, loss=tensor(0.5632, device='cuda:0'), lr=0.0004]

Steps:  12%|███████                                                    | 3588/30000 [20:15<2:25:34,  3.02it/s, loss=tensor(0.5031, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  12%|███████                                                    | 3592/30000 [20:16<2:25:39,  3.02it/s, loss=tensor(0.6751, device='cuda:0'), lr=0.0004]

Steps:  12%|███████                                                    | 3600/30000 [20:19<2:28:08,  2.97it/s, loss=tensor(0.6778, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  12%|███████                                                    | 3604/30000 [20:21<2:36:41,  2.81it/s, loss=tensor(0.5077, device='cuda:0'), lr=0.0004]

Steps:  12%|███████                                                    | 3608/30000 [20:22<2:33:42,  2.86it/s, loss=tensor(0.5199, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  12%|███████                                                    | 3616/30000 [20:25<2:29:31,  2.94it/s, loss=tensor(0.6299, device='cuda:0'), lr=0.0004]

Steps:  12%|███████                                                    | 3620/30000 [20:26<2:27:59,  2.97it/s, loss=tensor(0.5173, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  12%|███████▏                                                   | 3628/30000 [20:29<2:26:50,  2.99it/s, loss=tensor(0.4741, device='cuda:0'), lr=0.0004]

Steps:  12%|███████▏                                                   | 3636/30000 [20:31<2:25:48,  3.01it/s, loss=tensor(0.5264, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  12%|███████▏                                                   | 3640/30000 [20:33<2:25:38,  3.02it/s, loss=tensor(0.6189, device='cuda:0'), lr=0.0004]

Steps:  12%|███████▏                                                   | 3648/30000 [20:35<2:25:42,  3.01it/s, loss=tensor(0.6570, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  12%|███████▏                                                   | 3652/30000 [20:37<2:25:21,  3.02it/s, loss=tensor(0.5125, device='cuda:0'), lr=0.0004]

Steps:  12%|███████▏                                                   | 3660/30000 [20:39<2:24:59,  3.03it/s, loss=tensor(0.7781, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  12%|███████▏                                                   | 3664/30000 [20:41<2:25:12,  3.02it/s, loss=tensor(0.7022, device='cuda:0'), lr=0.0004]

Steps:  12%|███████▏                                                   | 3672/30000 [20:43<2:25:16,  3.02it/s, loss=tensor(0.6451, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  12%|███████▏                                                   | 3676/30000 [20:45<2:26:08,  3.00it/s, loss=tensor(0.5327, device='cuda:0'), lr=0.0004]

Steps:  12%|███████▏                                                   | 3684/30000 [20:47<2:25:25,  3.02it/s, loss=tensor(0.6088, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  12%|███████▎                                                   | 3688/30000 [20:49<2:25:22,  3.02it/s, loss=tensor(0.7347, device='cuda:0'), lr=0.0004]

Steps:  12%|███████▎                                                   | 3696/30000 [20:51<2:24:57,  3.02it/s, loss=tensor(0.5252, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  12%|███████▎                                                   | 3700/30000 [20:52<2:24:31,  3.03it/s, loss=tensor(0.6429, device='cuda:0'), lr=0.0004]

Steps:  12%|███████▎                                                   | 3708/30000 [20:55<2:24:29,  3.03it/s, loss=tensor(0.5239, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  12%|███████▎                                                   | 3712/30000 [20:56<2:24:53,  3.02it/s, loss=tensor(0.4513, device='cuda:0'), lr=0.0004]

Steps:  12%|███████▎                                                   | 3720/30000 [20:59<2:24:32,  3.03it/s, loss=tensor(0.5252, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  12%|███████▎                                                   | 3724/30000 [21:00<2:24:37,  3.03it/s, loss=tensor(0.4296, device='cuda:0'), lr=0.0004]

Steps:  12%|███████▎                                                   | 3732/30000 [21:03<2:25:13,  3.01it/s, loss=tensor(0.5942, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  12%|███████▎                                                   | 3736/30000 [21:04<2:24:32,  3.03it/s, loss=tensor(0.4469, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  12%|███████▎                                                   | 3744/30000 [21:07<2:25:09,  3.01it/s, loss=tensor(0.7151, device='cuda:0'), lr=0.0004]

Steps:  12%|███████▎                                                   | 3748/30000 [21:08<2:24:27,  3.03it/s, loss=tensor(0.4611, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  13%|███████▍                                                   | 3756/30000 [21:11<2:24:26,  3.03it/s, loss=tensor(0.4995, device='cuda:0'), lr=0.0004]

Steps:  13%|███████▍                                                   | 3760/30000 [21:12<2:25:10,  3.01it/s, loss=tensor(0.4411, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  13%|███████▍                                                   | 3768/30000 [21:15<2:24:17,  3.03it/s, loss=tensor(0.5048, device='cuda:0'), lr=0.0004]

Steps:  13%|███████▍                                                   | 3772/30000 [21:16<2:24:12,  3.03it/s, loss=tensor(0.5371, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  13%|███████▍                                                   | 3780/30000 [21:19<2:26:33,  2.98it/s, loss=tensor(0.5243, device='cuda:0'), lr=0.0004]

Steps:  13%|███████▍                                                   | 3784/30000 [21:21<2:36:31,  2.79it/s, loss=tensor(0.4961, device='cuda:0'), lr=0.0004]

Steps:  13%|███████▍                                                   | 3792/30000 [21:23<2:30:51,  2.90it/s, loss=tensor(0.6133, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  13%|███████▍                                                   | 3796/30000 [21:25<2:28:35,  2.94it/s, loss=tensor(0.5156, device='cuda:0'), lr=0.0004]

Steps:  13%|███████▍                                                   | 3804/30000 [21:27<2:26:36,  2.98it/s, loss=tensor(0.6263, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  13%|███████▍                                                   | 3808/30000 [21:29<2:25:42,  3.00it/s, loss=tensor(0.5375, device='cuda:0'), lr=0.0004]

Steps:  13%|███████▌                                                   | 3816/30000 [21:31<2:25:25,  3.00it/s, loss=tensor(0.6560, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  13%|███████▌                                                   | 3820/30000 [21:33<2:25:21,  3.00it/s, loss=tensor(0.5371, device='cuda:0'), lr=0.0004]

Steps:  13%|███████▌                                                   | 3828/30000 [21:35<2:24:49,  3.01it/s, loss=tensor(0.4352, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  13%|███████▌                                                   | 3832/30000 [21:37<2:24:31,  3.02it/s, loss=tensor(0.3617, device='cuda:0'), lr=0.0004]

Steps:  13%|███████▌                                                   | 3840/30000 [21:39<2:23:49,  3.03it/s, loss=tensor(0.5398, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  13%|███████▌                                                   | 3844/30000 [21:41<2:23:39,  3.03it/s, loss=tensor(0.5957, device='cuda:0'), lr=0.0004]

Steps:  13%|███████▌                                                   | 3852/30000 [21:43<2:24:23,  3.02it/s, loss=tensor(0.4818, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  13%|███████▌                                                   | 3856/30000 [21:44<2:24:40,  3.01it/s, loss=tensor(0.4920, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  13%|███████▌                                                   | 3864/30000 [21:47<2:23:43,  3.03it/s, loss=tensor(0.4816, device='cuda:0'), lr=0.0004]

Steps:  13%|███████▌                                                   | 3868/30000 [21:48<2:24:02,  3.02it/s, loss=tensor(0.6271, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  13%|███████▌                                                   | 3876/30000 [21:51<2:23:55,  3.03it/s, loss=tensor(0.6750, device='cuda:0'), lr=0.0004]

Steps:  13%|███████▋                                                   | 3880/30000 [21:52<2:24:03,  3.02it/s, loss=tensor(0.5031, device='cuda:0'), lr=0.0004]

Steps:  13%|███████▋                                                   | 3888/30000 [21:55<2:24:48,  3.01it/s, loss=tensor(0.5215, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  13%|███████▋                                                   | 3892/30000 [21:56<2:24:44,  3.01it/s, loss=tensor(0.5684, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  13%|███████▋                                                   | 3900/30000 [21:59<2:24:18,  3.01it/s, loss=tensor(0.5081, device='cuda:0'), lr=0.0004]

Steps:  13%|███████▋                                                   | 3904/30000 [22:00<2:24:38,  3.01it/s, loss=tensor(0.5129, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  13%|███████▋                                                   | 3912/30000 [22:03<2:24:11,  3.02it/s, loss=tensor(0.4947, device='cuda:0'), lr=0.0004]

Steps:  13%|███████▋                                                   | 3916/30000 [22:04<2:24:21,  3.01it/s, loss=tensor(0.7059, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  13%|███████▋                                                   | 3924/30000 [22:07<2:24:33,  3.01it/s, loss=tensor(0.5568, device='cuda:0'), lr=0.0004]

Steps:  13%|███████▋                                                   | 3928/30000 [22:08<2:24:02,  3.02it/s, loss=tensor(0.5184, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  13%|███████▋                                                   | 3936/30000 [22:11<2:23:54,  3.02it/s, loss=tensor(0.5803, device='cuda:0'), lr=0.0004]

Steps:  13%|███████▋                                                   | 3940/30000 [22:12<2:24:00,  3.02it/s, loss=tensor(0.5950, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  13%|███████▊                                                   | 3948/30000 [22:15<2:23:51,  3.02it/s, loss=tensor(0.5790, device='cuda:0'), lr=0.0004]

Steps:  13%|███████▊                                                   | 3956/30000 [22:18<2:23:28,  3.03it/s, loss=tensor(0.6374, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  13%|███████▊                                                   | 3960/30000 [22:19<2:26:34,  2.96it/s, loss=tensor(0.6478, device='cuda:0'), lr=0.0004]

Steps:  13%|███████▊                                                   | 3964/30000 [22:21<2:34:20,  2.81it/s, loss=tensor(0.6342, device='cuda:0'), lr=0.0004]

Steps:  13%|███████▊                                                   | 3972/30000 [22:23<2:29:21,  2.90it/s, loss=tensor(0.6186, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  13%|███████▊                                                   | 3976/30000 [22:25<2:27:07,  2.95it/s, loss=tensor(0.6334, device='cuda:0'), lr=0.0004]

Steps:  13%|███████▊                                                   | 3984/30000 [22:27<2:25:10,  2.99it/s, loss=tensor(0.6190, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  13%|███████▊                                                   | 3988/30000 [22:29<2:25:14,  2.98it/s, loss=tensor(0.7104, device='cuda:0'), lr=0.0004]

Steps:  13%|███████▊                                                   | 3996/30000 [22:31<2:24:18,  3.00it/s, loss=tensor(0.6087, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  13%|███████▊                                                   | 4000/30000 [22:33<2:23:30,  3.02it/s, loss=tensor(0.6087, device='cuda:0'), lr=0.0004]
save weights /ssd_scratch/cvit/vaibhav/ckpts/template_truck//lora_weight_e22_s4000.pt, /ssd_scratch/cvit/vaibhav/ckpts/template_truck//lora_weight_e22_s4000.text_encoder.pt
['CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'UNetMidBlock2DCrossAttn', 'Attention', 'Attention', 'GEGLU']
Cross Attention is also updated!
['CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'UNetMidBlock2DCrossAttn', 'Attention', 'Attention', 'GEGLU']
['CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention']
Saving weights to /ssd_scratch/cvit/vaibhav/ckpts/template_truck//lora_weight_e22_s4000.safetensors
['CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention']

Steps:  13%|███████▊                                                   | 4004/30000 [22:35<3:04:12,  2.35it/s, loss=tensor(0.7094, device='cuda:0'), lr=0.0004]

Steps:  13%|███████▉                                                   | 4008/30000 [22:36<2:51:39,  2.52it/s, loss=tensor(0.7037, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  13%|███████▉                                                   | 4016/30000 [22:39<2:37:41,  2.75it/s, loss=tensor(0.5513, device='cuda:0'), lr=0.0004]

Steps:  13%|███████▉                                                   | 4020/30000 [22:40<2:34:31,  2.80it/s, loss=tensor(0.4869, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  13%|███████▉                                                   | 4028/30000 [22:43<2:28:51,  2.91it/s, loss=tensor(0.5341, device='cuda:0'), lr=0.0004]

Steps:  13%|███████▉                                                   | 4032/30000 [22:44<2:26:39,  2.95it/s, loss=tensor(0.5368, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  13%|███████▉                                                   | 4040/30000 [22:47<2:24:29,  2.99it/s, loss=tensor(0.5792, device='cuda:0'), lr=0.0004]

Steps:  13%|███████▉                                                   | 4048/30000 [22:50<2:24:04,  3.00it/s, loss=tensor(0.5403, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  14%|███████▉                                                   | 4052/30000 [22:51<2:23:43,  3.01it/s, loss=tensor(0.5184, device='cuda:0'), lr=0.0004]

Steps:  14%|███████▉                                                   | 4060/30000 [22:54<2:22:56,  3.02it/s, loss=tensor(0.5701, device='cuda:0'), lr=0.0004]

Steps:  14%|███████▉                                                   | 4064/30000 [22:55<2:23:11,  3.02it/s, loss=tensor(0.5287, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  14%|████████                                                   | 4072/30000 [22:58<2:23:31,  3.01it/s, loss=tensor(0.4714, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  14%|████████                                                   | 4076/30000 [22:59<2:23:16,  3.02it/s, loss=tensor(0.5321, device='cuda:0'), lr=0.0004]

Steps:  14%|████████                                                   | 4084/30000 [23:02<2:22:38,  3.03it/s, loss=tensor(0.7617, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  14%|████████                                                   | 4088/30000 [23:03<2:22:36,  3.03it/s, loss=tensor(0.5048, device='cuda:0'), lr=0.0004]

Steps:  14%|████████                                                   | 4096/30000 [23:06<2:22:21,  3.03it/s, loss=tensor(0.5366, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  14%|████████                                                   | 4100/30000 [23:07<2:22:02,  3.04it/s, loss=tensor(0.5809, device='cuda:0'), lr=0.0004]

Steps:  14%|████████                                                   | 4108/30000 [23:10<2:22:46,  3.02it/s, loss=tensor(0.6100, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  14%|████████                                                   | 4112/30000 [23:11<2:23:07,  3.01it/s, loss=tensor(0.5484, device='cuda:0'), lr=0.0004]

Steps:  14%|████████                                                   | 4120/30000 [23:14<2:23:26,  3.01it/s, loss=tensor(0.5713, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  14%|████████                                                   | 4124/30000 [23:15<2:23:29,  3.01it/s, loss=tensor(0.4760, device='cuda:0'), lr=0.0004]

Steps:  14%|████████▏                                                  | 4132/30000 [23:18<2:22:29,  3.03it/s, loss=tensor(0.6314, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  14%|████████▏                                                  | 4136/30000 [23:19<2:22:36,  3.02it/s, loss=tensor(0.5087, device='cuda:0'), lr=0.0004]

Steps:  14%|████████▏                                                  | 4140/30000 [23:20<2:25:55,  2.95it/s, loss=tensor(0.6251, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  14%|████████▏                                                  | 4148/30000 [23:23<2:31:01,  2.85it/s, loss=tensor(0.4605, device='cuda:0'), lr=0.0004]

Steps:  14%|████████▏                                                  | 4152/30000 [23:25<2:28:05,  2.91it/s, loss=tensor(0.6175, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  14%|████████▏                                                  | 4160/30000 [23:27<2:25:14,  2.97it/s, loss=tensor(0.5415, device='cuda:0'), lr=0.0004]

Steps:  14%|████████▏                                                  | 4168/30000 [23:30<2:24:09,  2.99it/s, loss=tensor(0.5901, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  14%|████████▏                                                  | 4172/30000 [23:31<2:23:58,  2.99it/s, loss=tensor(0.5080, device='cuda:0'), lr=0.0004]

Steps:  14%|████████▏                                                  | 4180/30000 [23:34<2:23:27,  3.00it/s, loss=tensor(0.5443, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  14%|████████▏                                                  | 4184/30000 [23:35<2:23:12,  3.00it/s, loss=tensor(0.6324, device='cuda:0'), lr=0.0004]

Steps:  14%|████████▏                                                  | 4192/30000 [23:38<2:22:54,  3.01it/s, loss=tensor(0.5373, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  14%|████████▎                                                  | 4196/30000 [23:39<2:23:02,  3.01it/s, loss=tensor(0.6157, device='cuda:0'), lr=0.0004]

Steps:  14%|████████▎                                                  | 4204/30000 [23:42<2:22:17,  3.02it/s, loss=tensor(0.5348, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  14%|████████▎                                                  | 4208/30000 [23:43<2:22:43,  3.01it/s, loss=tensor(0.7091, device='cuda:0'), lr=0.0004]

Steps:  14%|████████▎                                                  | 4216/30000 [23:46<2:22:18,  3.02it/s, loss=tensor(0.6753, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  14%|████████▎                                                  | 4220/30000 [23:47<2:22:21,  3.02it/s, loss=tensor(0.7770, device='cuda:0'), lr=0.0004]

Steps:  14%|████████▎                                                  | 4228/30000 [23:50<2:22:19,  3.02it/s, loss=tensor(0.4486, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  14%|████████▎                                                  | 4232/30000 [23:51<2:22:41,  3.01it/s, loss=tensor(0.7023, device='cuda:0'), lr=0.0004]

Steps:  14%|████████▎                                                  | 4240/30000 [23:54<2:22:37,  3.01it/s, loss=tensor(0.4536, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  14%|████████▎                                                  | 4244/30000 [23:55<2:22:42,  3.01it/s, loss=tensor(0.7540, device='cuda:0'), lr=0.0004]

Steps:  14%|████████▎                                                  | 4252/30000 [23:58<2:23:01,  3.00it/s, loss=tensor(0.5089, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  14%|████████▎                                                  | 4256/30000 [23:59<2:22:52,  3.00it/s, loss=tensor(0.6195, device='cuda:0'), lr=0.0004]

Steps:  14%|████████▍                                                  | 4264/30000 [24:02<2:22:51,  3.00it/s, loss=tensor(0.5532, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  14%|████████▍                                                  | 4268/30000 [24:03<2:22:20,  3.01it/s, loss=tensor(0.5378, device='cuda:0'), lr=0.0004]

Steps:  14%|████████▍                                                  | 4276/30000 [24:06<2:21:55,  3.02it/s, loss=tensor(0.4319, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  14%|████████▍                                                  | 4280/30000 [24:07<2:22:20,  3.01it/s, loss=tensor(0.6868, device='cuda:0'), lr=0.0004]

Steps:  14%|████████▍                                                  | 4288/30000 [24:10<2:22:26,  3.01it/s, loss=tensor(0.5643, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  14%|████████▍                                                  | 4292/30000 [24:11<2:22:12,  3.01it/s, loss=tensor(0.6523, device='cuda:0'), lr=0.0004]

Steps:  14%|████████▍                                                  | 4300/30000 [24:14<2:21:46,  3.02it/s, loss=tensor(0.5584, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  14%|████████▍                                                  | 4304/30000 [24:15<2:21:58,  3.02it/s, loss=tensor(0.5141, device='cuda:0'), lr=0.0004]

Steps:  14%|████████▍                                                  | 4312/30000 [24:18<2:21:29,  3.03it/s, loss=tensor(0.5022, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  14%|████████▍                                                  | 4316/30000 [24:19<2:20:56,  3.04it/s, loss=tensor(0.5540, device='cuda:0'), lr=0.0004]

Steps:  14%|████████▌                                                  | 4324/30000 [24:22<2:31:36,  2.82it/s, loss=tensor(0.5462, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  14%|████████▌                                                  | 4328/30000 [24:23<2:28:29,  2.88it/s, loss=tensor(0.6167, device='cuda:0'), lr=0.0004]

Steps:  14%|████████▌                                                  | 4336/30000 [24:26<2:25:03,  2.95it/s, loss=tensor(0.6056, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  14%|████████▌                                                  | 4340/30000 [24:27<2:23:40,  2.98it/s, loss=tensor(0.5960, device='cuda:0'), lr=0.0004]

Steps:  14%|████████▌                                                  | 4348/30000 [24:30<2:23:03,  2.99it/s, loss=tensor(0.4249, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  15%|████████▌                                                  | 4352/30000 [24:31<2:22:44,  2.99it/s, loss=tensor(0.5159, device='cuda:0'), lr=0.0004]

Steps:  15%|████████▌                                                  | 4360/30000 [24:34<2:22:22,  3.00it/s, loss=tensor(0.5417, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  15%|████████▌                                                  | 4364/30000 [24:35<2:21:53,  3.01it/s, loss=tensor(0.4450, device='cuda:0'), lr=0.0004]

Steps:  15%|████████▌                                                  | 4372/30000 [24:38<2:21:27,  3.02it/s, loss=tensor(0.5542, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  15%|████████▌                                                  | 4376/30000 [24:39<2:21:40,  3.01it/s, loss=tensor(0.5298, device='cuda:0'), lr=0.0004]

Steps:  15%|████████▌                                                  | 4384/30000 [24:42<2:21:36,  3.01it/s, loss=tensor(0.5197, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  15%|████████▋                                                  | 4388/30000 [24:43<2:21:16,  3.02it/s, loss=tensor(0.4343, device='cuda:0'), lr=0.0004]

Steps:  15%|████████▋                                                  | 4396/30000 [24:46<2:21:16,  3.02it/s, loss=tensor(0.4651, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  15%|████████▋                                                  | 4400/30000 [24:47<2:20:57,  3.03it/s, loss=tensor(0.8470, device='cuda:0'), lr=0.0004]

Steps:  15%|████████▋                                                  | 4408/30000 [24:50<2:22:07,  3.00it/s, loss=tensor(0.4501, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  15%|████████▋                                                  | 4412/30000 [24:51<2:21:43,  3.01it/s, loss=tensor(0.4980, device='cuda:0'), lr=0.0004]

Steps:  15%|████████▋                                                  | 4420/30000 [24:54<2:21:59,  3.00it/s, loss=tensor(0.6268, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  15%|████████▋                                                  | 4424/30000 [24:55<2:22:40,  2.99it/s, loss=tensor(0.5609, device='cuda:0'), lr=0.0004]

Steps:  15%|████████▋                                                  | 4432/30000 [24:58<2:21:47,  3.01it/s, loss=tensor(0.4868, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  15%|████████▋                                                  | 4436/30000 [24:59<2:21:57,  3.00it/s, loss=tensor(0.6174, device='cuda:0'), lr=0.0004]

Steps:  15%|████████▋                                                  | 4444/30000 [25:02<2:21:09,  3.02it/s, loss=tensor(0.5078, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  15%|████████▋                                                  | 4448/30000 [25:03<2:20:41,  3.03it/s, loss=tensor(0.5476, device='cuda:0'), lr=0.0004]

Steps:  15%|████████▊                                                  | 4456/30000 [25:06<2:20:58,  3.02it/s, loss=tensor(0.5189, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  15%|████████▊                                                  | 4460/30000 [25:07<2:21:34,  3.01it/s, loss=tensor(0.5308, device='cuda:0'), lr=0.0004]

Steps:  15%|████████▊                                                  | 4468/30000 [25:10<2:21:32,  3.01it/s, loss=tensor(0.5067, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  15%|████████▊                                                  | 4472/30000 [25:11<2:21:22,  3.01it/s, loss=tensor(0.5504, device='cuda:0'), lr=0.0004]

Steps:  15%|████████▊                                                  | 4480/30000 [25:14<2:20:35,  3.03it/s, loss=tensor(0.5394, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  15%|████████▊                                                  | 4484/30000 [25:15<2:20:36,  3.02it/s, loss=tensor(0.6321, device='cuda:0'), lr=0.0004]

Steps:  15%|████████▊                                                  | 4492/30000 [25:18<2:20:47,  3.02it/s, loss=tensor(0.5253, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  15%|████████▊                                                  | 4496/30000 [25:19<2:20:49,  3.02it/s, loss=tensor(0.4989, device='cuda:0'), lr=0.0004]

Steps:  15%|████████▊                                                  | 4500/30000 [25:22<2:23:14,  2.97it/s, loss=tensor(0.4660, device='cuda:0'), lr=0.0004]
save weights /ssd_scratch/cvit/vaibhav/ckpts/template_truck//lora_weight_e24_s4500.pt, /ssd_scratch/cvit/vaibhav/ckpts/template_truck//lora_weight_e24_s4500.text_encoder.pt
['CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'UNetMidBlock2DCrossAttn', 'Attention', 'Attention', 'GEGLU']
Cross Attention is also updated!
['CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'UNetMidBlock2DCrossAttn', 'Attention', 'Attention', 'GEGLU']
['CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention']
Saving weights to /ssd_scratch/cvit/vaibhav/ckpts/template_truck//lora_weight_e24_s4500.safetensors
['CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention']
Stage 1 training: Disentangling object identity first

Steps:  15%|████████▊                                                  | 4508/30000 [25:25<3:13:23,  2.20it/s, loss=tensor(0.5883, device='cuda:0'), lr=0.0004]

Steps:  15%|████████▉                                                  | 4516/30000 [25:28<2:46:21,  2.55it/s, loss=tensor(0.6013, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  15%|████████▉                                                  | 4520/30000 [25:29<2:38:31,  2.68it/s, loss=tensor(0.6171, device='cuda:0'), lr=0.0004]

Steps:  15%|████████▉                                                  | 4528/30000 [25:32<2:29:29,  2.84it/s, loss=tensor(0.6675, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  15%|████████▉                                                  | 4532/30000 [25:33<2:26:38,  2.89it/s, loss=tensor(0.6106, device='cuda:0'), lr=0.0004]

Steps:  15%|████████▉                                                  | 4540/30000 [25:36<2:23:20,  2.96it/s, loss=tensor(0.6238, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  15%|████████▉                                                  | 4544/30000 [25:37<2:22:11,  2.98it/s, loss=tensor(0.6610, device='cuda:0'), lr=0.0004]

Steps:  15%|████████▉                                                  | 4552/30000 [25:40<2:25:42,  2.91it/s, loss=tensor(0.6921, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  15%|████████▉                                                  | 4556/30000 [25:41<2:24:22,  2.94it/s, loss=tensor(0.8360, device='cuda:0'), lr=0.0004]

Steps:  15%|████████▉                                                  | 4564/30000 [25:44<2:22:29,  2.98it/s, loss=tensor(0.4370, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  15%|████████▉                                                  | 4568/30000 [25:45<2:22:06,  2.98it/s, loss=tensor(0.5968, device='cuda:0'), lr=0.0004]

Steps:  15%|████████▉                                                  | 4576/30000 [25:48<2:21:08,  3.00it/s, loss=tensor(0.5555, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  15%|█████████                                                  | 4580/30000 [25:49<2:21:13,  3.00it/s, loss=tensor(0.5217, device='cuda:0'), lr=0.0004]

Steps:  15%|█████████                                                  | 4588/30000 [25:52<2:24:37,  2.93it/s, loss=tensor(0.4738, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  15%|█████████                                                  | 4592/30000 [25:53<2:23:16,  2.96it/s, loss=tensor(0.7388, device='cuda:0'), lr=0.0004]

Steps:  15%|█████████                                                  | 4600/30000 [25:56<2:21:18,  3.00it/s, loss=tensor(0.4959, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  15%|█████████                                                  | 4604/30000 [25:57<2:20:57,  3.00it/s, loss=tensor(0.5923, device='cuda:0'), lr=0.0004]

Steps:  15%|█████████                                                  | 4612/30000 [26:00<2:20:55,  3.00it/s, loss=tensor(0.3794, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  15%|█████████                                                  | 4616/30000 [26:01<2:20:58,  3.00it/s, loss=tensor(0.5358, device='cuda:0'), lr=0.0004]

Steps:  15%|█████████                                                  | 4624/30000 [26:04<2:20:09,  3.02it/s, loss=tensor(0.4923, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  15%|█████████                                                  | 4628/30000 [26:05<2:20:30,  3.01it/s, loss=tensor(0.5311, device='cuda:0'), lr=0.0004]

Steps:  15%|█████████                                                  | 4636/30000 [26:08<2:20:32,  3.01it/s, loss=tensor(0.7020, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  15%|█████████▏                                                 | 4640/30000 [26:09<2:19:53,  3.02it/s, loss=tensor(0.4109, device='cuda:0'), lr=0.0004]

Steps:  15%|█████████▏                                                 | 4648/30000 [26:12<2:20:23,  3.01it/s, loss=tensor(0.5975, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  16%|█████████▏                                                 | 4652/30000 [26:13<2:20:53,  3.00it/s, loss=tensor(0.5556, device='cuda:0'), lr=0.0004]

Steps:  16%|█████████▏                                                 | 4660/30000 [26:16<2:20:57,  3.00it/s, loss=tensor(0.5671, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  16%|█████████▏                                                 | 4664/30000 [26:17<2:20:59,  3.00it/s, loss=tensor(0.6043, device='cuda:0'), lr=0.0004]

Steps:  16%|█████████▏                                                 | 4672/30000 [26:20<2:20:01,  3.01it/s, loss=tensor(0.5349, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  16%|█████████▏                                                 | 4676/30000 [26:21<2:19:49,  3.02it/s, loss=tensor(0.5935, device='cuda:0'), lr=0.0004]

Steps:  16%|█████████▏                                                 | 4680/30000 [26:23<2:23:06,  2.95it/s, loss=tensor(0.6302, device='cuda:0'), lr=0.0004]

Steps:  16%|█████████▏                                                 | 4688/30000 [26:26<2:28:24,  2.84it/s, loss=tensor(0.7154, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  16%|█████████▏                                                 | 4696/30000 [26:28<2:23:40,  2.94it/s, loss=tensor(0.5031, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  16%|█████████▏                                                 | 4700/30000 [26:30<2:22:21,  2.96it/s, loss=tensor(0.6340, device='cuda:0'), lr=0.0004]

Steps:  16%|█████████▎                                                 | 4708/30000 [26:32<2:20:23,  3.00it/s, loss=tensor(0.4532, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  16%|█████████▎                                                 | 4712/30000 [26:34<2:20:20,  3.00it/s, loss=tensor(0.8711, device='cuda:0'), lr=0.0004]

Steps:  16%|█████████▎                                                 | 4720/30000 [26:36<2:20:11,  3.01it/s, loss=tensor(0.4809, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  16%|█████████▎                                                 | 4724/30000 [26:38<2:20:07,  3.01it/s, loss=tensor(0.6452, device='cuda:0'), lr=0.0004]

Steps:  16%|█████████▎                                                 | 4732/30000 [26:40<2:19:43,  3.01it/s, loss=tensor(0.7925, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  16%|█████████▎                                                 | 4736/30000 [26:42<2:19:39,  3.02it/s, loss=tensor(0.4164, device='cuda:0'), lr=0.0004]

Steps:  16%|█████████▎                                                 | 4744/30000 [26:44<2:19:07,  3.03it/s, loss=tensor(0.5476, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  16%|█████████▎                                                 | 4748/30000 [26:46<2:19:20,  3.02it/s, loss=tensor(0.5455, device='cuda:0'), lr=0.0004]

Steps:  16%|█████████▎                                                 | 4756/30000 [26:48<2:19:32,  3.02it/s, loss=tensor(0.6737, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  16%|█████████▎                                                 | 4760/30000 [26:50<2:19:54,  3.01it/s, loss=tensor(0.6626, device='cuda:0'), lr=0.0004]

Steps:  16%|█████████▍                                                 | 4768/30000 [26:52<2:19:02,  3.02it/s, loss=tensor(0.3659, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  16%|█████████▍                                                 | 4772/30000 [26:53<2:19:58,  3.00it/s, loss=tensor(0.5336, device='cuda:0'), lr=0.0004]

Steps:  16%|█████████▍                                                 | 4780/30000 [26:56<2:19:21,  3.02it/s, loss=tensor(0.4773, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  16%|█████████▍                                                 | 4784/30000 [26:57<2:19:41,  3.01it/s, loss=tensor(0.5262, device='cuda:0'), lr=0.0004]

Steps:  16%|█████████▍                                                 | 4792/30000 [27:00<2:19:44,  3.01it/s, loss=tensor(0.5202, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  16%|█████████▍                                                 | 4796/30000 [27:01<2:19:22,  3.01it/s, loss=tensor(0.6946, device='cuda:0'), lr=0.0004]

Steps:  16%|█████████▍                                                 | 4804/30000 [27:04<2:18:55,  3.02it/s, loss=tensor(0.6476, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  16%|█████████▍                                                 | 4808/30000 [27:05<2:18:53,  3.02it/s, loss=tensor(0.7413, device='cuda:0'), lr=0.0004]

Steps:  16%|█████████▍                                                 | 4816/30000 [27:08<2:18:43,  3.03it/s, loss=tensor(0.5348, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  16%|█████████▍                                                 | 4820/30000 [27:09<2:18:44,  3.02it/s, loss=tensor(0.6003, device='cuda:0'), lr=0.0004]

Steps:  16%|█████████▍                                                 | 4828/30000 [27:12<2:19:08,  3.02it/s, loss=tensor(0.5979, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  16%|█████████▌                                                 | 4832/30000 [27:13<2:18:40,  3.02it/s, loss=tensor(0.7243, device='cuda:0'), lr=0.0004]

Steps:  16%|█████████▌                                                 | 4840/30000 [27:16<2:18:32,  3.03it/s, loss=tensor(0.5151, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  16%|█████████▌                                                 | 4844/30000 [27:17<2:18:52,  3.02it/s, loss=tensor(0.5332, device='cuda:0'), lr=0.0004]

Steps:  16%|█████████▌                                                 | 4852/30000 [27:20<2:18:59,  3.02it/s, loss=tensor(0.4416, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  16%|█████████▌                                                 | 4856/30000 [27:21<2:19:20,  3.01it/s, loss=tensor(0.5000, device='cuda:0'), lr=0.0004]

Steps:  16%|█████████▌                                                 | 4864/30000 [27:24<2:28:41,  2.82it/s, loss=tensor(0.5240, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  16%|█████████▌                                                 | 4868/30000 [27:26<2:25:54,  2.87it/s, loss=tensor(0.4068, device='cuda:0'), lr=0.0004]

Steps:  16%|█████████▌                                                 | 4876/30000 [27:28<2:22:21,  2.94it/s, loss=tensor(0.4774, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  16%|█████████▌                                                 | 4880/30000 [27:30<2:21:01,  2.97it/s, loss=tensor(0.5629, device='cuda:0'), lr=0.0004]

Steps:  16%|█████████▌                                                 | 4888/30000 [27:32<2:20:14,  2.98it/s, loss=tensor(0.4817, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  16%|█████████▌                                                 | 4892/30000 [27:34<2:19:51,  2.99it/s, loss=tensor(0.6155, device='cuda:0'), lr=0.0004]

Steps:  16%|█████████▋                                                 | 4900/30000 [27:36<2:19:40,  2.99it/s, loss=tensor(0.4226, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  16%|█████████▋                                                 | 4904/30000 [27:38<2:19:05,  3.01it/s, loss=tensor(0.5337, device='cuda:0'), lr=0.0004]

Steps:  16%|█████████▋                                                 | 4912/30000 [27:40<2:18:30,  3.02it/s, loss=tensor(0.4174, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  16%|█████████▋                                                 | 4916/30000 [27:42<2:18:47,  3.01it/s, loss=tensor(0.4568, device='cuda:0'), lr=0.0004]

Steps:  16%|█████████▋                                                 | 4924/30000 [27:44<2:18:35,  3.02it/s, loss=tensor(0.4203, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  16%|█████████▋                                                 | 4928/30000 [27:46<2:18:37,  3.01it/s, loss=tensor(0.5137, device='cuda:0'), lr=0.0004]

Steps:  16%|█████████▋                                                 | 4936/30000 [27:48<2:18:37,  3.01it/s, loss=tensor(0.5369, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  16%|█████████▋                                                 | 4940/30000 [27:50<2:19:45,  2.99it/s, loss=tensor(0.4889, device='cuda:0'), lr=0.0004]

Steps:  16%|█████████▋                                                 | 4948/30000 [27:52<2:18:50,  3.01it/s, loss=tensor(0.5881, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  17%|█████████▋                                                 | 4952/30000 [27:54<2:18:41,  3.01it/s, loss=tensor(0.6535, device='cuda:0'), lr=0.0004]

Steps:  17%|█████████▊                                                 | 4960/30000 [27:56<2:18:07,  3.02it/s, loss=tensor(0.5796, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  17%|█████████▊                                                 | 4964/30000 [27:58<2:18:28,  3.01it/s, loss=tensor(0.6876, device='cuda:0'), lr=0.0004]

Steps:  17%|█████████▊                                                 | 4972/30000 [28:00<2:17:53,  3.03it/s, loss=tensor(0.5028, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  17%|█████████▊                                                 | 4976/30000 [28:01<2:17:58,  3.02it/s, loss=tensor(0.6352, device='cuda:0'), lr=0.0004]

Steps:  17%|█████████▊                                                 | 4984/30000 [28:04<2:18:05,  3.02it/s, loss=tensor(0.5729, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  17%|█████████▊                                                 | 4988/30000 [28:05<2:17:39,  3.03it/s, loss=tensor(0.4349, device='cuda:0'), lr=0.0004]

Steps:  17%|█████████▊                                                 | 4996/30000 [28:08<2:17:59,  3.02it/s, loss=tensor(0.6524, device='cuda:0'), lr=0.0004]
Stage 1 training: Disentangling object identity first

Steps:  17%|█████████▊                                                 | 5000/30000 [28:10<2:17:31,  3.03it/s, loss=tensor(0.5200, device='cuda:0'), lr=0.0004]
save weights /ssd_scratch/cvit/vaibhav/ckpts/template_truck//lora_weight_e27_s5000.pt, /ssd_scratch/cvit/vaibhav/ckpts/template_truck//lora_weight_e27_s5000.text_encoder.pt
['CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'UNetMidBlock2DCrossAttn', 'Attention', 'Attention', 'GEGLU']
Cross Attention is also updated!
['CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'UNetMidBlock2DCrossAttn', 'Attention', 'Attention', 'GEGLU']
['CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention']
Saving weights to /ssd_scratch/cvit/vaibhav/ckpts/template_truck//lora_weight_e27_s5000.safetensors
['CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention']

Steps:  17%|█████████▊                                                 | 5004/30000 [28:12<2:44:50,  2.53it/s, loss=tensor(0.5442, device='cuda:0'), lr=0.0004]
Steps:  17%|█████████▊                                                 | 5004/30000 [28:12<2:44:50,  2.53it/s, loss=tensor(0.5442, device='cuda:0'), lr=0.0004]/home2/vaibhav19ada/miniconda3/envs/contwords/lib/python3.9/site-packages/torch/nn/utils/clip_grad.py:39: UserWarning: The .grad attribute of a Tensor that is not a leaf Tensor is being accessed. Its .grad attribute won't be populated during autograd.backward(). If you indeed want the .grad field to be populated for a non-leaf Tensor, use .retain_grad() on the non-leaf Tensor. If you access the non-leaf Tensor by mistake, make sure you access the leaf Tensor instead. See github.com/pytorch/pytorch/pull/30531 for more informations. (Triggered internally at /opt/conda/conda-bld/pytorch_1682343964576/work/build/aten/src/ATen/core/TensorBody.h:486.)
  grads = [p.grad for p in parameters if p.grad is not None]
Steps:  17%|█████████▊                                                 | 5012/30000 [28:14<2:31:14,  2.75it/s, loss=tensor(0.5751, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  17%|█████████▊                                                 | 5016/30000 [28:16<2:27:30,  2.82it/s, loss=tensor(0.5624, device='cuda:0'), lr=0.0004]

Steps:  17%|█████████▉                                                 | 5024/30000 [28:18<2:22:51,  2.91it/s, loss=tensor(0.5672, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  17%|█████████▉                                                 | 5028/30000 [28:20<2:21:26,  2.94it/s, loss=tensor(0.4569, device='cuda:0'), lr=0.0004]

Steps:  17%|█████████▉                                                 | 5036/30000 [28:22<2:19:17,  2.99it/s, loss=tensor(0.5543, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  17%|█████████▉                                                 | 5040/30000 [28:24<2:21:44,  2.94it/s, loss=tensor(0.7059, device='cuda:0'), lr=0.0004]

Steps:  17%|█████████▉                                                 | 5048/30000 [28:27<2:26:33,  2.84it/s, loss=tensor(0.6904, device='cuda:0'), lr=0.0004]

Steps:  17%|█████████▉                                                 | 5052/30000 [28:28<2:24:23,  2.88it/s, loss=tensor(0.5413, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  17%|█████████▉                                                 | 5060/30000 [28:31<2:21:26,  2.94it/s, loss=tensor(0.5092, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  17%|█████████▉                                                 | 5064/30000 [28:32<2:20:36,  2.96it/s, loss=tensor(0.6888, device='cuda:0'), lr=0.0004]

Steps:  17%|█████████▉                                                 | 5072/30000 [28:35<2:19:06,  2.99it/s, loss=tensor(0.5607, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  17%|█████████▉                                                 | 5076/30000 [28:36<2:18:31,  3.00it/s, loss=tensor(0.4382, device='cuda:0'), lr=0.0004]

Steps:  17%|█████████▉                                                 | 5084/30000 [28:39<2:18:19,  3.00it/s, loss=tensor(0.4311, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  17%|██████████                                                 | 5088/30000 [28:40<2:18:11,  3.00it/s, loss=tensor(0.5533, device='cuda:0'), lr=0.0004]

Steps:  17%|██████████                                                 | 5096/30000 [28:43<2:17:46,  3.01it/s, loss=tensor(0.6905, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  17%|██████████                                                 | 5100/30000 [28:44<2:17:47,  3.01it/s, loss=tensor(0.7070, device='cuda:0'), lr=0.0004]

Steps:  17%|██████████                                                 | 5108/30000 [28:46<2:17:27,  3.02it/s, loss=tensor(0.4165, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  17%|██████████                                                 | 5112/30000 [28:48<2:17:11,  3.02it/s, loss=tensor(0.4440, device='cuda:0'), lr=0.0004]

Steps:  17%|██████████                                                 | 5120/30000 [28:50<2:17:17,  3.02it/s, loss=tensor(0.4788, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  17%|██████████                                                 | 5124/30000 [28:52<2:17:34,  3.01it/s, loss=tensor(0.6088, device='cuda:0'), lr=0.0004]

Steps:  17%|██████████                                                 | 5132/30000 [28:54<2:17:18,  3.02it/s, loss=tensor(0.5845, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  17%|██████████                                                 | 5136/30000 [28:56<2:17:12,  3.02it/s, loss=tensor(0.6302, device='cuda:0'), lr=0.0004]

Steps:  17%|██████████                                                 | 5144/30000 [28:58<2:17:20,  3.02it/s, loss=tensor(0.4777, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  17%|██████████                                                 | 5148/30000 [29:00<2:16:59,  3.02it/s, loss=tensor(0.5366, device='cuda:0'), lr=0.0004]

Steps:  17%|██████████▏                                                | 5156/30000 [29:02<2:17:31,  3.01it/s, loss=tensor(0.5115, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  17%|██████████▏                                                | 5160/30000 [29:04<2:17:42,  3.01it/s, loss=tensor(0.7453, device='cuda:0'), lr=0.0004]

Steps:  17%|██████████▏                                                | 5168/30000 [29:06<2:17:00,  3.02it/s, loss=tensor(0.6657, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  17%|██████████▏                                                | 5172/30000 [29:08<2:17:18,  3.01it/s, loss=tensor(0.5658, device='cuda:0'), lr=0.0004]

Steps:  17%|██████████▏                                                | 5180/30000 [29:10<2:17:06,  3.02it/s, loss=tensor(0.4644, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  17%|██████████▏                                                | 5184/30000 [29:12<2:17:58,  3.00it/s, loss=tensor(0.7607, device='cuda:0'), lr=0.0004]

Steps:  17%|██████████▏                                                | 5192/30000 [29:14<2:17:53,  3.00it/s, loss=tensor(0.5175, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  17%|██████████▏                                                | 5196/30000 [29:16<2:17:48,  3.00it/s, loss=tensor(0.4833, device='cuda:0'), lr=0.0004]

Steps:  17%|██████████▏                                                | 5204/30000 [29:18<2:17:23,  3.01it/s, loss=tensor(0.4542, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  17%|██████████▏                                                | 5208/30000 [29:20<2:17:20,  3.01it/s, loss=tensor(0.6067, device='cuda:0'), lr=0.0004]

Steps:  17%|██████████▎                                                | 5216/30000 [29:22<2:17:17,  3.01it/s, loss=tensor(0.6526, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  17%|██████████▎                                                | 5220/30000 [29:24<2:19:48,  2.95it/s, loss=tensor(0.4183, device='cuda:0'), lr=0.0004]

Steps:  17%|██████████▎                                                | 5228/30000 [29:27<2:24:46,  2.85it/s, loss=tensor(0.5709, device='cuda:0'), lr=0.0004]

Steps:  17%|██████████▎                                                | 5232/30000 [29:28<2:23:26,  2.88it/s, loss=tensor(0.4884, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  17%|██████████▎                                                | 5240/30000 [29:31<2:20:17,  2.94it/s, loss=tensor(0.5100, device='cuda:0'), lr=0.0004]

Steps:  17%|██████████▎                                                | 5244/30000 [29:32<2:19:18,  2.96it/s, loss=tensor(0.6068, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  18%|██████████▎                                                | 5252/30000 [29:35<2:17:45,  2.99it/s, loss=tensor(0.5083, device='cuda:0'), lr=0.0004]

Steps:  18%|██████████▎                                                | 5256/30000 [29:36<2:17:35,  3.00it/s, loss=tensor(0.4925, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  18%|██████████▎                                                | 5264/30000 [29:39<2:17:17,  3.00it/s, loss=tensor(0.4983, device='cuda:0'), lr=0.0004]

Steps:  18%|██████████▎                                                | 5268/30000 [29:40<2:16:44,  3.01it/s, loss=tensor(0.4627, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  18%|██████████▍                                                | 5276/30000 [29:43<2:16:51,  3.01it/s, loss=tensor(0.7376, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  18%|██████████▍                                                | 5280/30000 [29:44<2:16:20,  3.02it/s, loss=tensor(0.5010, device='cuda:0'), lr=0.0004]

Steps:  18%|██████████▍                                                | 5288/30000 [29:47<2:16:18,  3.02it/s, loss=tensor(0.5747, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  18%|██████████▍                                                | 5292/30000 [29:48<2:16:14,  3.02it/s, loss=tensor(0.6597, device='cuda:0'), lr=0.0004]

Steps:  18%|██████████▍                                                | 5300/30000 [29:51<2:16:40,  3.01it/s, loss=tensor(0.5521, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  18%|██████████▍                                                | 5304/30000 [29:52<2:17:08,  3.00it/s, loss=tensor(0.4662, device='cuda:0'), lr=0.0004]

Steps:  18%|██████████▍                                                | 5312/30000 [29:55<2:16:45,  3.01it/s, loss=tensor(0.6126, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  18%|██████████▍                                                | 5316/30000 [29:56<2:17:00,  3.00it/s, loss=tensor(0.4510, device='cuda:0'), lr=0.0004]

Steps:  18%|██████████▍                                                | 5324/30000 [29:59<2:17:00,  3.00it/s, loss=tensor(0.6372, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  18%|██████████▍                                                | 5328/30000 [30:00<2:16:48,  3.01it/s, loss=tensor(0.3881, device='cuda:0'), lr=0.0004]

Steps:  18%|██████████▍                                                | 5336/30000 [30:03<2:17:32,  2.99it/s, loss=tensor(0.4446, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  18%|██████████▌                                                | 5340/30000 [30:04<2:17:17,  2.99it/s, loss=tensor(0.4633, device='cuda:0'), lr=0.0004]

Steps:  18%|██████████▌                                                | 5348/30000 [30:07<2:17:19,  2.99it/s, loss=tensor(0.4547, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  18%|██████████▌                                                | 5352/30000 [30:08<2:17:11,  2.99it/s, loss=tensor(0.4773, device='cuda:0'), lr=0.0004]

Steps:  18%|██████████▌                                                | 5360/30000 [30:11<2:16:48,  3.00it/s, loss=tensor(0.5301, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  18%|██████████▌                                                | 5364/30000 [30:12<2:16:25,  3.01it/s, loss=tensor(0.5701, device='cuda:0'), lr=0.0004]

Steps:  18%|██████████▌                                                | 5368/30000 [30:13<2:16:29,  3.01it/s, loss=tensor(0.4785, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  18%|██████████▌                                                | 5376/30000 [30:16<2:15:46,  3.02it/s, loss=tensor(0.5953, device='cuda:0'), lr=0.0004]

Steps:  18%|██████████▌                                                | 5380/30000 [30:17<2:15:50,  3.02it/s, loss=tensor(0.5444, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  18%|██████████▌                                                | 5388/30000 [30:20<2:16:41,  3.00it/s, loss=tensor(0.4367, device='cuda:0'), lr=0.0004]

Steps:  18%|██████████▌                                                | 5392/30000 [30:21<2:16:31,  3.00it/s, loss=tensor(0.6154, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  18%|██████████▌                                                | 5400/30000 [30:24<2:18:36,  2.96it/s, loss=tensor(0.5911, device='cuda:0'), lr=0.0004]

Steps:  18%|██████████▋                                                | 5404/30000 [30:26<2:25:37,  2.82it/s, loss=tensor(0.6264, device='cuda:0'), lr=0.0004]

Steps:  18%|██████████▋                                                | 5412/30000 [30:28<2:20:49,  2.91it/s, loss=tensor(0.6078, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  18%|██████████▋                                                | 5416/30000 [30:30<2:20:04,  2.93it/s, loss=tensor(0.4585, device='cuda:0'), lr=0.0004]

Steps:  18%|██████████▋                                                | 5424/30000 [30:32<2:18:39,  2.95it/s, loss=tensor(0.6749, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  18%|██████████▋                                                | 5428/30000 [30:34<2:17:55,  2.97it/s, loss=tensor(0.5952, device='cuda:0'), lr=0.0004]

Steps:  18%|██████████▋                                                | 5436/30000 [30:36<2:18:17,  2.96it/s, loss=tensor(0.5070, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  18%|██████████▋                                                | 5440/30000 [30:38<2:17:55,  2.97it/s, loss=tensor(0.6052, device='cuda:0'), lr=0.0004]

Steps:  18%|██████████▋                                                | 5448/30000 [30:40<2:17:03,  2.99it/s, loss=tensor(0.5215, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  18%|██████████▋                                                | 5452/30000 [30:42<2:16:58,  2.99it/s, loss=tensor(0.6173, device='cuda:0'), lr=0.0004]

Steps:  18%|██████████▋                                                | 5460/30000 [30:44<2:16:09,  3.00it/s, loss=tensor(0.6458, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  18%|██████████▋                                                | 5464/30000 [30:46<2:16:09,  3.00it/s, loss=tensor(0.5074, device='cuda:0'), lr=0.0004]

Steps:  18%|██████████▊                                                | 5472/30000 [30:48<2:15:55,  3.01it/s, loss=tensor(0.6331, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  18%|██████████▊                                                | 5476/30000 [30:50<2:15:49,  3.01it/s, loss=tensor(0.5291, device='cuda:0'), lr=0.0004]

Steps:  18%|██████████▊                                                | 5484/30000 [30:52<2:15:51,  3.01it/s, loss=tensor(0.5988, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  18%|██████████▊                                                | 5488/30000 [30:54<2:15:31,  3.01it/s, loss=tensor(0.3998, device='cuda:0'), lr=0.0004]

Steps:  18%|██████████▊                                                | 5496/30000 [30:56<2:16:33,  2.99it/s, loss=tensor(0.6301, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  18%|██████████▊                                                | 5500/30000 [30:58<2:16:07,  3.00it/s, loss=tensor(0.6301, device='cuda:0'), lr=0.0004]
save weights /ssd_scratch/cvit/vaibhav/ckpts/template_truck//lora_weight_e30_s5500.pt, /ssd_scratch/cvit/vaibhav/ckpts/template_truck//lora_weight_e30_s5500.text_encoder.pt
['CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'UNetMidBlock2DCrossAttn', 'Attention', 'Attention', 'GEGLU']
Cross Attention is also updated!
['CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'UNetMidBlock2DCrossAttn', 'Attention', 'Attention', 'GEGLU']
['CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention']
Saving weights to /ssd_scratch/cvit/vaibhav/ckpts/template_truck//lora_weight_e30_s5500.safetensors

Steps:  18%|██████████▊                                                | 5504/30000 [31:00<2:55:19,  2.33it/s, loss=tensor(0.6008, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  18%|██████████▊                                                | 5508/30000 [31:02<2:43:50,  2.49it/s, loss=tensor(0.4188, device='cuda:0'), lr=0.0004]

Steps:  18%|██████████▊                                                | 5516/30000 [31:04<2:29:03,  2.74it/s, loss=tensor(0.5860, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  18%|██████████▊                                                | 5520/30000 [31:06<2:25:06,  2.81it/s, loss=tensor(0.6588, device='cuda:0'), lr=0.0004]

Steps:  18%|██████████▊                                                | 5528/30000 [31:08<2:20:26,  2.90it/s, loss=tensor(0.5356, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  18%|██████████▉                                                | 5532/30000 [31:10<2:18:36,  2.94it/s, loss=tensor(0.5965, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  18%|██████████▉                                                | 5540/30000 [31:12<2:16:20,  2.99it/s, loss=tensor(0.4191, device='cuda:0'), lr=0.0004]

Steps:  18%|██████████▉                                                | 5544/30000 [31:14<2:16:12,  2.99it/s, loss=tensor(0.5344, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  19%|██████████▉                                                | 5552/30000 [31:16<2:15:45,  3.00it/s, loss=tensor(0.6013, device='cuda:0'), lr=0.0004]

Steps:  19%|██████████▉                                                | 5556/30000 [31:18<2:15:06,  3.02it/s, loss=tensor(0.4965, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  19%|██████████▉                                                | 5564/30000 [31:20<2:15:16,  3.01it/s, loss=tensor(0.5831, device='cuda:0'), lr=0.0004]

Steps:  19%|██████████▉                                                | 5568/30000 [31:21<2:15:11,  3.01it/s, loss=tensor(0.3915, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  19%|██████████▉                                                | 5576/30000 [31:24<2:15:38,  3.00it/s, loss=tensor(0.5034, device='cuda:0'), lr=0.0004]

Steps:  19%|██████████▉                                                | 5580/30000 [31:26<2:17:33,  2.96it/s, loss=tensor(0.5254, device='cuda:0'), lr=0.0004]

Steps:  19%|██████████▉                                                | 5588/30000 [31:29<2:23:00,  2.85it/s, loss=tensor(0.5531, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  19%|██████████▉                                                | 5592/30000 [31:30<2:20:50,  2.89it/s, loss=tensor(0.6392, device='cuda:0'), lr=0.0004]

Steps:  19%|███████████                                                | 5600/30000 [31:33<2:18:09,  2.94it/s, loss=tensor(0.5206, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  19%|███████████                                                | 5604/30000 [31:34<2:17:06,  2.97it/s, loss=tensor(0.5010, device='cuda:0'), lr=0.0004]

Steps:  19%|███████████                                                | 5612/30000 [31:36<2:15:58,  2.99it/s, loss=tensor(0.6009, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  19%|███████████                                                | 5616/30000 [31:38<2:15:09,  3.01it/s, loss=tensor(0.5844, device='cuda:0'), lr=0.0004]

Steps:  19%|███████████                                                | 5624/30000 [31:40<2:15:17,  3.00it/s, loss=tensor(0.7943, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  19%|███████████                                                | 5628/30000 [31:42<2:14:30,  3.02it/s, loss=tensor(0.5236, device='cuda:0'), lr=0.0004]

Steps:  19%|███████████                                                | 5636/30000 [31:44<2:14:57,  3.01it/s, loss=tensor(0.5172, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  19%|███████████                                                | 5640/30000 [31:46<2:14:59,  3.01it/s, loss=tensor(0.7760, device='cuda:0'), lr=0.0004]

Steps:  19%|███████████                                                | 5648/30000 [31:48<2:14:49,  3.01it/s, loss=tensor(0.6688, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  19%|███████████                                                | 5652/30000 [31:50<2:14:40,  3.01it/s, loss=tensor(0.5075, device='cuda:0'), lr=0.0004]

Steps:  19%|███████████▏                                               | 5660/30000 [31:52<2:15:00,  3.00it/s, loss=tensor(0.5861, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  19%|███████████▏                                               | 5664/30000 [31:54<2:15:00,  3.00it/s, loss=tensor(0.5166, device='cuda:0'), lr=0.0004]

Steps:  19%|███████████▏                                               | 5672/30000 [31:56<2:15:49,  2.99it/s, loss=tensor(0.6235, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  19%|███████████▏                                               | 5676/30000 [31:58<2:14:54,  3.00it/s, loss=tensor(0.5897, device='cuda:0'), lr=0.0004]

Steps:  19%|███████████▏                                               | 5684/30000 [32:00<2:14:31,  3.01it/s, loss=tensor(0.5799, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  19%|███████████▏                                               | 5688/30000 [32:02<2:14:42,  3.01it/s, loss=tensor(0.4460, device='cuda:0'), lr=0.0004]

Steps:  19%|███████████▏                                               | 5696/30000 [32:04<2:14:16,  3.02it/s, loss=tensor(0.5912, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  19%|███████████▏                                               | 5700/30000 [32:06<2:14:33,  3.01it/s, loss=tensor(0.4361, device='cuda:0'), lr=0.0004]

Steps:  19%|███████████▏                                               | 5708/30000 [32:08<2:14:34,  3.01it/s, loss=tensor(0.4100, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  19%|███████████▏                                               | 5712/30000 [32:10<2:14:16,  3.01it/s, loss=tensor(0.4316, device='cuda:0'), lr=0.0004]

Steps:  19%|███████████▏                                               | 5720/30000 [32:12<2:14:09,  3.02it/s, loss=tensor(0.6388, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  19%|███████████▎                                               | 5724/30000 [32:14<2:14:51,  3.00it/s, loss=tensor(0.5502, device='cuda:0'), lr=0.0004]

Steps:  19%|███████████▎                                               | 5732/30000 [32:16<2:14:50,  3.00it/s, loss=tensor(0.6210, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  19%|███████████▎                                               | 5736/30000 [32:18<2:14:57,  3.00it/s, loss=tensor(0.5494, device='cuda:0'), lr=0.0004]

Steps:  19%|███████████▎                                               | 5744/30000 [32:20<2:14:54,  3.00it/s, loss=tensor(0.9042, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  19%|███████████▎                                               | 5748/30000 [32:22<2:14:37,  3.00it/s, loss=tensor(0.5893, device='cuda:0'), lr=0.0004]

Steps:  19%|███████████▎                                               | 5756/30000 [32:24<2:13:32,  3.03it/s, loss=tensor(0.6046, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  19%|███████████▎                                               | 5760/30000 [32:26<2:16:09,  2.97it/s, loss=tensor(0.6824, device='cuda:0'), lr=0.0004]

Steps:  19%|███████████▎                                               | 5768/30000 [32:29<2:21:28,  2.85it/s, loss=tensor(0.6491, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  19%|███████████▎                                               | 5772/30000 [32:30<2:19:06,  2.90it/s, loss=tensor(0.5602, device='cuda:0'), lr=0.0004]

Steps:  19%|███████████▎                                               | 5780/30000 [32:33<2:16:14,  2.96it/s, loss=tensor(0.5270, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  19%|███████████▍                                               | 5784/30000 [32:34<2:15:32,  2.98it/s, loss=tensor(0.5442, device='cuda:0'), lr=0.0004]

Steps:  19%|███████████▍                                               | 5792/30000 [32:37<2:18:21,  2.92it/s, loss=tensor(0.4350, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  19%|███████████▍                                               | 5796/30000 [32:38<2:16:50,  2.95it/s, loss=tensor(0.5391, device='cuda:0'), lr=0.0004]

Steps:  19%|███████████▍                                               | 5804/30000 [32:41<2:15:24,  2.98it/s, loss=tensor(0.6003, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  19%|███████████▍                                               | 5808/30000 [32:42<2:14:47,  2.99it/s, loss=tensor(0.5330, device='cuda:0'), lr=0.0004]

Steps:  19%|███████████▍                                               | 5816/30000 [32:45<2:13:33,  3.02it/s, loss=tensor(0.5423, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  19%|███████████▍                                               | 5820/30000 [32:46<2:13:27,  3.02it/s, loss=tensor(0.4280, device='cuda:0'), lr=0.0004]

Steps:  19%|███████████▍                                               | 5828/30000 [32:49<2:14:14,  3.00it/s, loss=tensor(0.4196, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  19%|███████████▍                                               | 5832/30000 [32:50<2:14:08,  3.00it/s, loss=tensor(0.4069, device='cuda:0'), lr=0.0004]

Steps:  19%|███████████▍                                               | 5840/30000 [32:53<2:13:49,  3.01it/s, loss=tensor(0.5045, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  19%|███████████▍                                               | 5844/30000 [32:54<2:13:41,  3.01it/s, loss=tensor(0.4227, device='cuda:0'), lr=0.0004]

Steps:  20%|███████████▌                                               | 5852/30000 [32:57<2:13:38,  3.01it/s, loss=tensor(0.6199, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  20%|███████████▌                                               | 5856/30000 [32:58<2:14:04,  3.00it/s, loss=tensor(0.5455, device='cuda:0'), lr=0.0004]

Steps:  20%|███████████▌                                               | 5864/30000 [33:01<2:14:02,  3.00it/s, loss=tensor(0.6070, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  20%|███████████▌                                               | 5868/30000 [33:02<2:13:27,  3.01it/s, loss=tensor(0.5427, device='cuda:0'), lr=0.0004]

Steps:  20%|███████████▌                                               | 5876/30000 [33:05<2:13:24,  3.01it/s, loss=tensor(0.6151, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  20%|███████████▌                                               | 5880/30000 [33:06<2:12:54,  3.02it/s, loss=tensor(0.4217, device='cuda:0'), lr=0.0004]

Steps:  20%|███████████▌                                               | 5888/30000 [33:09<2:12:39,  3.03it/s, loss=tensor(0.5929, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  20%|███████████▌                                               | 5892/30000 [33:10<2:12:39,  3.03it/s, loss=tensor(0.5180, device='cuda:0'), lr=0.0004]

Steps:  20%|███████████▌                                               | 5900/30000 [33:13<2:13:12,  3.02it/s, loss=tensor(0.6071, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  20%|███████████▌                                               | 5904/30000 [33:14<2:12:58,  3.02it/s, loss=tensor(0.5926, device='cuda:0'), lr=0.0004]

Steps:  20%|███████████▋                                               | 5912/30000 [33:17<2:12:53,  3.02it/s, loss=tensor(0.7128, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  20%|███████████▋                                               | 5916/30000 [33:18<2:13:12,  3.01it/s, loss=tensor(0.5939, device='cuda:0'), lr=0.0004]

Steps:  20%|███████████▋                                               | 5924/30000 [33:21<2:13:00,  3.02it/s, loss=tensor(0.5394, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  20%|███████████▋                                               | 5928/30000 [33:22<2:13:11,  3.01it/s, loss=tensor(0.4591, device='cuda:0'), lr=0.0004]

Steps:  20%|███████████▋                                               | 5936/30000 [33:25<2:12:45,  3.02it/s, loss=tensor(0.6358, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  20%|███████████▋                                               | 5940/30000 [33:26<2:15:22,  2.96it/s, loss=tensor(0.6030, device='cuda:0'), lr=0.0004]

Steps:  20%|███████████▋                                               | 5948/30000 [33:29<2:19:19,  2.88it/s, loss=tensor(0.4479, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  20%|███████████▋                                               | 5952/30000 [33:30<2:18:00,  2.90it/s, loss=tensor(0.4633, device='cuda:0'), lr=0.0004]

Steps:  20%|███████████▋                                               | 5960/30000 [33:33<2:20:14,  2.86it/s, loss=tensor(0.5002, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  20%|███████████▋                                               | 5964/30000 [33:34<2:18:33,  2.89it/s, loss=tensor(0.5572, device='cuda:0'), lr=0.0004]

Steps:  20%|███████████▋                                               | 5972/30000 [33:37<2:16:06,  2.94it/s, loss=tensor(0.5341, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  20%|███████████▊                                               | 5976/30000 [33:38<2:14:46,  2.97it/s, loss=tensor(0.4668, device='cuda:0'), lr=0.0004]

Steps:  20%|███████████▊                                               | 5984/30000 [33:41<2:13:45,  2.99it/s, loss=tensor(0.5547, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  20%|███████████▊                                               | 5988/30000 [33:42<2:13:07,  3.01it/s, loss=tensor(0.4170, device='cuda:0'), lr=0.0004]

Steps:  20%|███████████▊                                               | 5996/30000 [33:45<2:12:17,  3.02it/s, loss=tensor(0.6421, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP


Steps:  20%|███████████▊                                               | 6000/30000 [33:48<2:12:09,  3.03it/s, loss=tensor(0.4977, device='cuda:0'), lr=0.0004]
save weights /ssd_scratch/cvit/vaibhav/ckpts/template_truck//lora_weight_e33_s6000.pt, /ssd_scratch/cvit/vaibhav/ckpts/template_truck//lora_weight_e33_s6000.text_encoder.pt
['CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'UNetMidBlock2DCrossAttn', 'Attention', 'Attention', 'GEGLU']
Cross Attention is also updated!
['CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'UNetMidBlock2DCrossAttn', 'Attention', 'Attention', 'GEGLU']
['CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention']
Saving weights to /ssd_scratch/cvit/vaibhav/ckpts/template_truck//lora_weight_e33_s6000.safetensors
['CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention']

Steps:  20%|███████████▊                                               | 6008/30000 [33:51<2:51:36,  2.33it/s, loss=tensor(0.3661, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  20%|███████████▊                                               | 6012/30000 [33:52<2:40:10,  2.50it/s, loss=tensor(0.5751, device='cuda:0'), lr=0.0004]

Steps:  20%|███████████▊                                               | 6020/30000 [33:55<2:26:01,  2.74it/s, loss=tensor(0.7390, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  20%|███████████▊                                               | 6024/30000 [33:56<2:22:10,  2.81it/s, loss=tensor(0.6429, device='cuda:0'), lr=0.0004]

Steps:  20%|███████████▊                                               | 6032/30000 [33:59<2:16:48,  2.92it/s, loss=tensor(0.6096, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  20%|███████████▊                                               | 6036/30000 [34:00<2:15:37,  2.94it/s, loss=tensor(0.4714, device='cuda:0'), lr=0.0004]

Steps:  20%|███████████▉                                               | 6044/30000 [34:03<2:13:45,  2.99it/s, loss=tensor(0.7598, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  20%|███████████▉                                               | 6048/30000 [34:04<2:13:29,  2.99it/s, loss=tensor(0.5315, device='cuda:0'), lr=0.0004]

Steps:  20%|███████████▉                                               | 6056/30000 [34:07<2:12:45,  3.01it/s, loss=tensor(0.4834, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  20%|███████████▉                                               | 6060/30000 [34:08<2:12:54,  3.00it/s, loss=tensor(0.4633, device='cuda:0'), lr=0.0004]

Steps:  20%|███████████▉                                               | 6068/30000 [34:11<2:12:13,  3.02it/s, loss=tensor(0.5078, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  20%|███████████▉                                               | 6072/30000 [34:12<2:12:32,  3.01it/s, loss=tensor(0.7130, device='cuda:0'), lr=0.0004]

Steps:  20%|███████████▉                                               | 6080/30000 [34:15<2:12:48,  3.00it/s, loss=tensor(0.4998, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  20%|███████████▉                                               | 6084/30000 [34:16<2:12:13,  3.01it/s, loss=tensor(0.5244, device='cuda:0'), lr=0.0004]

Steps:  20%|███████████▉                                               | 6092/30000 [34:19<2:11:53,  3.02it/s, loss=tensor(0.5155, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  20%|███████████▉                                               | 6096/30000 [34:20<2:12:08,  3.01it/s, loss=tensor(0.4105, device='cuda:0'), lr=0.0004]

Steps:  20%|████████████                                               | 6104/30000 [34:23<2:12:20,  3.01it/s, loss=tensor(0.6250, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  20%|████████████                                               | 6108/30000 [34:24<2:12:28,  3.01it/s, loss=tensor(0.5029, device='cuda:0'), lr=0.0004]

Steps:  20%|████████████                                               | 6116/30000 [34:27<2:11:57,  3.02it/s, loss=tensor(0.6051, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  20%|████████████                                               | 6120/30000 [34:28<2:14:33,  2.96it/s, loss=tensor(0.6206, device='cuda:0'), lr=0.0004]

Steps:  20%|████████████                                               | 6128/30000 [34:31<2:19:46,  2.85it/s, loss=tensor(0.5453, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  20%|████████████                                               | 6132/30000 [34:32<2:17:32,  2.89it/s, loss=tensor(0.5471, device='cuda:0'), lr=0.0004]

Steps:  20%|████████████                                               | 6140/30000 [34:35<2:15:23,  2.94it/s, loss=tensor(0.5399, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  20%|████████████                                               | 6144/30000 [34:36<2:14:10,  2.96it/s, loss=tensor(0.4421, device='cuda:0'), lr=0.0004]

Steps:  20%|████████████                                               | 6148/30000 [34:38<2:13:09,  2.99it/s, loss=tensor(0.6082, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  21%|████████████                                               | 6156/30000 [34:40<2:12:40,  3.00it/s, loss=tensor(0.7353, device='cuda:0'), lr=0.0004]

Steps:  21%|████████████                                               | 6164/30000 [34:43<2:12:32,  3.00it/s, loss=tensor(0.5697, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  21%|████████████▏                                              | 6168/30000 [34:44<2:12:26,  3.00it/s, loss=tensor(0.4626, device='cuda:0'), lr=0.0004]

Steps:  21%|████████████▏                                              | 6176/30000 [34:47<2:12:48,  2.99it/s, loss=tensor(0.5822, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  21%|████████████▏                                              | 6180/30000 [34:48<2:12:20,  3.00it/s, loss=tensor(0.4366, device='cuda:0'), lr=0.0004]

Steps:  21%|████████████▏                                              | 6188/30000 [34:51<2:11:44,  3.01it/s, loss=tensor(0.4673, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  21%|████████████▏                                              | 6192/30000 [34:52<2:12:18,  3.00it/s, loss=tensor(0.5580, device='cuda:0'), lr=0.0004]

Steps:  21%|████████████▏                                              | 6200/30000 [34:55<2:12:03,  3.00it/s, loss=tensor(0.5139, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  21%|████████████▏                                              | 6204/30000 [34:56<2:11:48,  3.01it/s, loss=tensor(0.5712, device='cuda:0'), lr=0.0004]

Steps:  21%|████████████▏                                              | 6212/30000 [34:59<2:11:26,  3.02it/s, loss=tensor(0.5505, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  21%|████████████▏                                              | 6216/30000 [35:00<2:11:03,  3.02it/s, loss=tensor(0.6877, device='cuda:0'), lr=0.0004]

Steps:  21%|████████████▏                                              | 6224/30000 [35:03<2:11:34,  3.01it/s, loss=tensor(0.6001, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  21%|████████████▏                                              | 6228/30000 [35:04<2:11:36,  3.01it/s, loss=tensor(0.6776, device='cuda:0'), lr=0.0004]

Steps:  21%|████████████▎                                              | 6236/30000 [35:07<2:11:13,  3.02it/s, loss=tensor(0.4543, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  21%|████████████▎                                              | 6240/30000 [35:08<2:10:48,  3.03it/s, loss=tensor(0.4203, device='cuda:0'), lr=0.0004]

Steps:  21%|████████████▎                                              | 6248/30000 [35:11<2:11:13,  3.02it/s, loss=tensor(0.9320, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  21%|████████████▎                                              | 6252/30000 [35:12<2:10:55,  3.02it/s, loss=tensor(0.5995, device='cuda:0'), lr=0.0004]

Steps:  21%|████████████▎                                              | 6260/30000 [35:15<2:11:12,  3.02it/s, loss=tensor(0.6959, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  21%|████████████▎                                              | 6264/30000 [35:16<2:11:10,  3.02it/s, loss=tensor(0.6699, device='cuda:0'), lr=0.0004]

Steps:  21%|████████████▎                                              | 6272/30000 [35:19<2:11:26,  3.01it/s, loss=tensor(0.4680, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  21%|████████████▎                                              | 6276/30000 [35:20<2:11:18,  3.01it/s, loss=tensor(0.4815, device='cuda:0'), lr=0.0004]

Steps:  21%|████████████▎                                              | 6284/30000 [35:23<2:11:02,  3.02it/s, loss=tensor(0.3855, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  21%|████████████▎                                              | 6288/30000 [35:24<2:11:26,  3.01it/s, loss=tensor(0.5329, device='cuda:0'), lr=0.0004]

Steps:  21%|████████████▍                                              | 6296/30000 [35:27<2:10:48,  3.02it/s, loss=tensor(0.5065, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  21%|████████████▍                                              | 6300/30000 [35:28<2:12:47,  2.97it/s, loss=tensor(0.5778, device='cuda:0'), lr=0.0004]

Steps:  21%|████████████▍                                              | 6308/30000 [35:31<2:17:22,  2.87it/s, loss=tensor(0.7551, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  21%|████████████▍                                              | 6312/30000 [35:32<2:15:30,  2.91it/s, loss=tensor(0.4582, device='cuda:0'), lr=0.0004]

Steps:  21%|████████████▍                                              | 6320/30000 [35:35<2:13:30,  2.96it/s, loss=tensor(0.6068, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  21%|████████████▍                                              | 6324/30000 [35:36<2:12:43,  2.97it/s, loss=tensor(0.5304, device='cuda:0'), lr=0.0004]

Steps:  21%|████████████▍                                              | 6332/30000 [35:39<2:12:15,  2.98it/s, loss=tensor(0.4318, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  21%|████████████▍                                              | 6336/30000 [35:40<2:11:38,  3.00it/s, loss=tensor(0.6109, device='cuda:0'), lr=0.0004]

Steps:  21%|████████████▍                                              | 6344/30000 [35:43<2:10:48,  3.01it/s, loss=tensor(0.5727, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  21%|████████████▍                                              | 6348/30000 [35:44<2:11:02,  3.01it/s, loss=tensor(0.4138, device='cuda:0'), lr=0.0004]

Steps:  21%|████████████▌                                              | 6356/30000 [35:47<2:10:27,  3.02it/s, loss=tensor(0.5036, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  21%|████████████▌                                              | 6360/30000 [35:48<2:10:28,  3.02it/s, loss=tensor(0.4404, device='cuda:0'), lr=0.0004]

Steps:  21%|████████████▌                                              | 6368/30000 [35:51<2:10:16,  3.02it/s, loss=tensor(0.8158, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  21%|████████████▌                                              | 6372/30000 [35:52<2:10:38,  3.01it/s, loss=tensor(0.6325, device='cuda:0'), lr=0.0004]

Steps:  21%|████████████▌                                              | 6380/30000 [35:55<2:10:29,  3.02it/s, loss=tensor(0.4298, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  21%|████████████▌                                              | 6384/30000 [35:56<2:10:11,  3.02it/s, loss=tensor(0.5673, device='cuda:0'), lr=0.0004]

Steps:  21%|████████████▌                                              | 6392/30000 [35:59<2:11:11,  3.00it/s, loss=tensor(0.5363, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  21%|████████████▌                                              | 6396/30000 [36:00<2:10:32,  3.01it/s, loss=tensor(0.4802, device='cuda:0'), lr=0.0004]

Steps:  21%|████████████▌                                              | 6404/30000 [36:03<2:10:18,  3.02it/s, loss=tensor(0.6588, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  21%|████████████▌                                              | 6408/30000 [36:04<2:11:00,  3.00it/s, loss=tensor(0.4887, device='cuda:0'), lr=0.0004]

Steps:  21%|████████████▌                                              | 6416/30000 [36:07<2:10:46,  3.01it/s, loss=tensor(0.5786, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  21%|████████████▋                                              | 6420/30000 [36:08<2:10:25,  3.01it/s, loss=tensor(0.5184, device='cuda:0'), lr=0.0004]

Steps:  21%|████████████▋                                              | 6428/30000 [36:11<2:09:56,  3.02it/s, loss=tensor(0.5664, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  21%|████████████▋                                              | 6432/30000 [36:12<2:09:27,  3.03it/s, loss=tensor(0.6706, device='cuda:0'), lr=0.0004]

Steps:  21%|████████████▋                                              | 6440/30000 [36:15<2:10:06,  3.02it/s, loss=tensor(0.5074, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  21%|████████████▋                                              | 6444/30000 [36:16<2:10:24,  3.01it/s, loss=tensor(0.6341, device='cuda:0'), lr=0.0004]

Steps:  22%|████████████▋                                              | 6452/30000 [36:19<2:09:55,  3.02it/s, loss=tensor(0.6314, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  22%|████████████▋                                              | 6456/30000 [36:20<2:09:51,  3.02it/s, loss=tensor(0.6272, device='cuda:0'), lr=0.0004]

Steps:  22%|████████████▋                                              | 6464/30000 [36:23<2:10:18,  3.01it/s, loss=tensor(0.7085, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  22%|████████████▋                                              | 6472/30000 [36:26<2:10:23,  3.01it/s, loss=tensor(0.4347, device='cuda:0'), lr=0.0004]

Steps:  22%|████████████▋                                              | 6476/30000 [36:27<2:10:21,  3.01it/s, loss=tensor(0.4474, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  22%|████████████▋                                              | 6480/30000 [36:28<2:12:24,  2.96it/s, loss=tensor(0.5762, device='cuda:0'), lr=0.0004]

Steps:  22%|████████████▊                                              | 6488/30000 [36:31<2:16:35,  2.87it/s, loss=tensor(0.4747, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  22%|████████████▊                                              | 6492/30000 [36:33<2:14:40,  2.91it/s, loss=tensor(0.4188, device='cuda:0'), lr=0.0004]

Steps:  22%|████████████▊                                              | 6500/30000 [36:35<2:12:48,  2.95it/s, loss=tensor(0.6277, device='cuda:0'), lr=0.0004]

Steps:  22%|████████████▊                                              | 6504/30000 [36:37<2:36:32,  2.50it/s, loss=tensor(0.5123, device='cuda:0'), lr=0.0004]
save weights /ssd_scratch/cvit/vaibhav/ckpts/template_truck//lora_weight_e36_s6500.pt, /ssd_scratch/cvit/vaibhav/ckpts/template_truck//lora_weight_e36_s6500.text_encoder.pt
['CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'UNetMidBlock2DCrossAttn', 'Attention', 'Attention', 'GEGLU']
Cross Attention is also updated!
['CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'UNetMidBlock2DCrossAttn', 'Attention', 'Attention', 'GEGLU']
['CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention']
Saving weights to /ssd_scratch/cvit/vaibhav/ckpts/template_truck//lora_weight_e36_s6500.safetensors
['CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention']
Stage 2 training: Learning Continuous Word MLP

Steps:  22%|████████████▊                                              | 6508/30000 [36:39<2:28:21,  2.64it/s, loss=tensor(0.6552, device='cuda:0'), lr=0.0004]

Steps:  22%|████████████▊                                              | 6516/30000 [36:41<2:18:58,  2.82it/s, loss=tensor(0.5930, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  22%|████████████▊                                              | 6520/30000 [36:43<2:16:13,  2.87it/s, loss=tensor(0.6246, device='cuda:0'), lr=0.0004]

Steps:  22%|████████████▊                                              | 6528/30000 [36:45<2:14:10,  2.92it/s, loss=tensor(0.4244, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  22%|████████████▊                                              | 6532/30000 [36:47<2:12:27,  2.95it/s, loss=tensor(0.4623, device='cuda:0'), lr=0.0004]

Steps:  22%|████████████▊                                              | 6540/30000 [36:49<2:10:37,  2.99it/s, loss=tensor(0.7675, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  22%|████████████▊                                              | 6544/30000 [36:51<2:10:17,  3.00it/s, loss=tensor(0.6065, device='cuda:0'), lr=0.0004]

Steps:  22%|████████████▉                                              | 6552/30000 [36:53<2:09:33,  3.02it/s, loss=tensor(0.5953, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  22%|████████████▉                                              | 6556/30000 [36:55<2:09:23,  3.02it/s, loss=tensor(0.5692, device='cuda:0'), lr=0.0004]

Steps:  22%|████████████▉                                              | 6564/30000 [36:57<2:10:19,  3.00it/s, loss=tensor(0.4497, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  22%|████████████▉                                              | 6568/30000 [36:59<2:10:29,  2.99it/s, loss=tensor(0.4120, device='cuda:0'), lr=0.0004]

Steps:  22%|████████████▉                                              | 6576/30000 [37:01<2:10:28,  2.99it/s, loss=tensor(0.5768, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  22%|████████████▉                                              | 6580/30000 [37:03<2:10:11,  3.00it/s, loss=tensor(0.6415, device='cuda:0'), lr=0.0004]

Steps:  22%|████████████▉                                              | 6588/30000 [37:05<2:09:57,  3.00it/s, loss=tensor(0.6757, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  22%|████████████▉                                              | 6592/30000 [37:07<2:09:31,  3.01it/s, loss=tensor(0.6948, device='cuda:0'), lr=0.0004]

Steps:  22%|████████████▉                                              | 6600/30000 [37:09<2:10:17,  2.99it/s, loss=tensor(0.4940, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  22%|████████████▉                                              | 6604/30000 [37:11<2:09:48,  3.00it/s, loss=tensor(0.7316, device='cuda:0'), lr=0.0004]

Steps:  22%|█████████████                                              | 6612/30000 [37:13<2:09:07,  3.02it/s, loss=tensor(0.6127, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  22%|█████████████                                              | 6616/30000 [37:15<2:09:15,  3.02it/s, loss=tensor(0.4490, device='cuda:0'), lr=0.0004]

Steps:  22%|█████████████                                              | 6624/30000 [37:17<2:09:00,  3.02it/s, loss=tensor(0.6565, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  22%|█████████████                                              | 6628/30000 [37:19<2:09:09,  3.02it/s, loss=tensor(0.5251, device='cuda:0'), lr=0.0004]

Steps:  22%|█████████████                                              | 6636/30000 [37:21<2:09:23,  3.01it/s, loss=tensor(0.6396, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  22%|█████████████                                              | 6640/30000 [37:23<2:09:57,  3.00it/s, loss=tensor(0.6734, device='cuda:0'), lr=0.0004]

Steps:  22%|█████████████                                              | 6648/30000 [37:25<2:09:44,  3.00it/s, loss=tensor(0.6319, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  22%|█████████████                                              | 6652/30000 [37:27<2:09:42,  3.00it/s, loss=tensor(0.5729, device='cuda:0'), lr=0.0004]

Steps:  22%|█████████████                                              | 6660/30000 [37:29<2:11:43,  2.95it/s, loss=tensor(0.6079, device='cuda:0'), lr=0.0004]

Steps:  22%|█████████████                                              | 6664/30000 [37:31<2:18:24,  2.81it/s, loss=tensor(0.4362, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  22%|█████████████                                              | 6672/30000 [37:34<2:14:02,  2.90it/s, loss=tensor(0.6183, device='cuda:0'), lr=0.0004]

Steps:  22%|█████████████▏                                             | 6676/30000 [37:35<2:12:16,  2.94it/s, loss=tensor(0.4685, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  22%|█████████████▏                                             | 6684/30000 [37:38<2:11:49,  2.95it/s, loss=tensor(0.5909, device='cuda:0'), lr=0.0004]

Steps:  22%|█████████████▏                                             | 6688/30000 [37:39<2:11:02,  2.97it/s, loss=tensor(0.4762, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  22%|█████████████▏                                             | 6696/30000 [37:42<2:10:25,  2.98it/s, loss=tensor(0.7255, device='cuda:0'), lr=0.0004]

Steps:  22%|█████████████▏                                             | 6700/30000 [37:43<2:09:44,  2.99it/s, loss=tensor(0.4827, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  22%|█████████████▏                                             | 6708/30000 [37:46<2:09:12,  3.00it/s, loss=tensor(0.5636, device='cuda:0'), lr=0.0004]

Steps:  22%|█████████████▏                                             | 6712/30000 [37:47<2:09:52,  2.99it/s, loss=tensor(0.4912, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  22%|█████████████▏                                             | 6720/30000 [37:50<2:09:20,  3.00it/s, loss=tensor(0.6246, device='cuda:0'), lr=0.0004]

Steps:  22%|█████████████▏                                             | 6724/30000 [37:51<2:09:00,  3.01it/s, loss=tensor(0.5280, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  22%|█████████████▏                                             | 6732/30000 [37:54<2:09:03,  3.00it/s, loss=tensor(0.4303, device='cuda:0'), lr=0.0004]

Steps:  22%|█████████████▏                                             | 6736/30000 [37:55<2:08:54,  3.01it/s, loss=tensor(0.5856, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  22%|█████████████▎                                             | 6744/30000 [37:58<2:08:55,  3.01it/s, loss=tensor(0.5683, device='cuda:0'), lr=0.0004]

Steps:  22%|█████████████▎                                             | 6748/30000 [37:59<2:08:48,  3.01it/s, loss=tensor(0.5418, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  23%|█████████████▎                                             | 6756/30000 [38:02<2:09:00,  3.00it/s, loss=tensor(0.5040, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  23%|█████████████▎                                             | 6760/30000 [38:03<2:08:31,  3.01it/s, loss=tensor(0.5625, device='cuda:0'), lr=0.0004]

Steps:  23%|█████████████▎                                             | 6768/30000 [38:06<2:09:15,  3.00it/s, loss=tensor(0.4738, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  23%|█████████████▎                                             | 6772/30000 [38:07<2:09:03,  3.00it/s, loss=tensor(0.6986, device='cuda:0'), lr=0.0004]

Steps:  23%|█████████████▎                                             | 6780/30000 [38:10<2:09:41,  2.98it/s, loss=tensor(0.6419, device='cuda:0'), lr=0.0004]

Steps:  23%|█████████████▎                                             | 6784/30000 [38:11<2:09:02,  3.00it/s, loss=tensor(0.4586, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  23%|█████████████▎                                             | 6792/30000 [38:14<2:08:38,  3.01it/s, loss=tensor(0.6964, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  23%|█████████████▎                                             | 6796/30000 [38:15<2:08:42,  3.00it/s, loss=tensor(0.6428, device='cuda:0'), lr=0.0004]

Steps:  23%|█████████████▍                                             | 6804/30000 [38:18<2:08:56,  3.00it/s, loss=tensor(0.5257, device='cuda:0'), lr=0.0004]

Steps:  23%|█████████████▍                                             | 6808/30000 [38:19<2:08:56,  3.00it/s, loss=tensor(0.5596, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  23%|█████████████▍                                             | 6816/30000 [38:22<2:08:46,  3.00it/s, loss=tensor(0.5354, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  23%|█████████████▍                                             | 6820/30000 [38:23<2:09:00,  2.99it/s, loss=tensor(0.6637, device='cuda:0'), lr=0.0004]

Steps:  23%|█████████████▍                                             | 6828/30000 [38:26<2:08:15,  3.01it/s, loss=tensor(0.6212, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  23%|█████████████▍                                             | 6832/30000 [38:27<2:08:20,  3.01it/s, loss=tensor(0.6156, device='cuda:0'), lr=0.0004]

Steps:  23%|█████████████▍                                             | 6840/30000 [38:30<2:10:18,  2.96it/s, loss=tensor(0.4732, device='cuda:0'), lr=0.0004]

Steps:  23%|█████████████▍                                             | 6844/30000 [38:31<2:17:16,  2.81it/s, loss=tensor(0.6829, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  23%|█████████████▍                                             | 6852/30000 [38:34<2:13:00,  2.90it/s, loss=tensor(0.5440, device='cuda:0'), lr=0.0004]

Steps:  23%|█████████████▍                                             | 6856/30000 [38:35<2:11:33,  2.93it/s, loss=tensor(0.5561, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  23%|█████████████▍                                             | 6864/30000 [38:38<2:09:28,  2.98it/s, loss=tensor(0.5795, device='cuda:0'), lr=0.0004]

Steps:  23%|█████████████▌                                             | 6868/30000 [38:39<2:09:36,  2.97it/s, loss=tensor(0.4493, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  23%|█████████████▌                                             | 6876/30000 [38:42<2:08:54,  2.99it/s, loss=tensor(0.7104, device='cuda:0'), lr=0.0004]

Steps:  23%|█████████████▌                                             | 6880/30000 [38:43<2:08:45,  2.99it/s, loss=tensor(0.7197, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  23%|█████████████▌                                             | 6888/30000 [38:46<2:08:02,  3.01it/s, loss=tensor(0.3956, device='cuda:0'), lr=0.0004]

Steps:  23%|█████████████▌                                             | 6892/30000 [38:47<2:08:00,  3.01it/s, loss=tensor(0.4328, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  23%|█████████████▌                                             | 6900/30000 [38:50<2:08:04,  3.01it/s, loss=tensor(0.5044, device='cuda:0'), lr=0.0004]

Steps:  23%|█████████████▌                                             | 6904/30000 [38:51<2:07:58,  3.01it/s, loss=tensor(0.5988, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  23%|█████████████▌                                             | 6912/30000 [38:54<2:07:56,  3.01it/s, loss=tensor(0.5962, device='cuda:0'), lr=0.0004]

Steps:  23%|█████████████▌                                             | 6916/30000 [38:55<2:08:10,  3.00it/s, loss=tensor(0.5249, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  23%|█████████████▌                                             | 6924/30000 [38:58<2:08:17,  3.00it/s, loss=tensor(0.5520, device='cuda:0'), lr=0.0004]

Steps:  23%|█████████████▋                                             | 6928/30000 [38:59<2:08:45,  2.99it/s, loss=tensor(0.8136, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  23%|█████████████▋                                             | 6936/30000 [39:02<2:08:44,  2.99it/s, loss=tensor(0.5721, device='cuda:0'), lr=0.0004]

Steps:  23%|█████████████▋                                             | 6940/30000 [39:03<2:08:07,  3.00it/s, loss=tensor(0.4792, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  23%|█████████████▋                                             | 6948/30000 [39:06<2:07:39,  3.01it/s, loss=tensor(0.4735, device='cuda:0'), lr=0.0004]

Steps:  23%|█████████████▋                                             | 6952/30000 [39:07<2:07:31,  3.01it/s, loss=tensor(0.4455, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  23%|█████████████▋                                             | 6960/30000 [39:10<2:07:48,  3.00it/s, loss=tensor(0.5102, device='cuda:0'), lr=0.0004]

Steps:  23%|█████████████▋                                             | 6964/30000 [39:11<2:07:14,  3.02it/s, loss=tensor(0.6614, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  23%|█████████████▋                                             | 6972/30000 [39:14<2:07:44,  3.00it/s, loss=tensor(0.4299, device='cuda:0'), lr=0.0004]

Steps:  23%|█████████████▋                                             | 6976/30000 [39:15<2:07:40,  3.01it/s, loss=tensor(0.4062, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  23%|█████████████▋                                             | 6984/30000 [39:18<2:07:19,  3.01it/s, loss=tensor(0.4924, device='cuda:0'), lr=0.0004]

Steps:  23%|█████████████▋                                             | 6988/30000 [39:19<2:07:31,  3.01it/s, loss=tensor(0.5772, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  23%|█████████████▊                                             | 6996/30000 [39:22<2:07:02,  3.02it/s, loss=tensor(0.5237, device='cuda:0'), lr=0.0004]

Steps:  23%|█████████████▊                                             | 7000/30000 [39:23<2:12:57,  2.88it/s, loss=tensor(0.5237, device='cuda:0'), lr=0.0004]

Steps:  23%|█████████████▊                                             | 7004/30000 [39:25<2:35:50,  2.46it/s, loss=tensor(0.4339, device='cuda:0'), lr=0.0004]
save weights /ssd_scratch/cvit/vaibhav/ckpts/template_truck//lora_weight_e38_s7000.pt, /ssd_scratch/cvit/vaibhav/ckpts/template_truck//lora_weight_e38_s7000.text_encoder.pt
['CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'UNetMidBlock2DCrossAttn', 'Attention', 'Attention', 'GEGLU']
Cross Attention is also updated!
['CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnDownBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'CrossAttnUpBlock2D', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'Attention', 'Attention', 'GEGLU', 'UNetMidBlock2DCrossAttn', 'Attention', 'Attention', 'GEGLU']
['CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention']
Saving weights to /ssd_scratch/cvit/vaibhav/ckpts/template_truck//lora_weight_e38_s7000.safetensors
['CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention', 'CLIPAttention']
Stage 2 training: Learning Continuous Word MLP

Steps:  23%|█████████████▊                                             | 7008/30000 [39:27<2:27:59,  2.59it/s, loss=tensor(0.4705, device='cuda:0'), lr=0.0004]

Steps:  23%|█████████████▊                                             | 7016/30000 [39:29<2:17:44,  2.78it/s, loss=tensor(0.5635, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  23%|█████████████▊                                             | 7020/30000 [39:31<2:17:35,  2.78it/s, loss=tensor(0.4880, device='cuda:0'), lr=0.0004]

Steps:  23%|█████████████▊                                             | 7028/30000 [39:34<2:17:24,  2.79it/s, loss=tensor(0.4195, device='cuda:0'), lr=0.0004]

Steps:  23%|█████████████▊                                             | 7032/30000 [39:35<2:14:07,  2.85it/s, loss=tensor(0.5329, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  23%|█████████████▊                                             | 7040/30000 [39:38<2:10:38,  2.93it/s, loss=tensor(0.3893, device='cuda:0'), lr=0.0004]

Steps:  23%|█████████████▊                                             | 7044/30000 [39:39<2:09:41,  2.95it/s, loss=tensor(0.5533, device='cuda:0'), lr=0.0004]
Stage 2 training: Learning Continuous Word MLP

Steps:  24%|█████████████▊                                             | 7052/30000 [39:42<2:08:20,  2.98it/s, loss=tensor(0.5013, device='cuda:0'), lr=0.0004]
